<div class="trades-popup-overlay" *ngIf="visible" (click)="onClose()">
  <div class="trades-popup" (click)="$event.stopPropagation()">
    <!-- Header -->
    <div class="popup-header">
      <div class="header-content">
        <div class="date-info">
          <span class="date">{{ selectedDate }}</span>
          <span class="separator">|</span>
          <span class="net-pnl" [ngClass]="netPnl >= 0 ? 'positive' : 'negative'">
            P&L {{ netPnl >= 0 ? '+' : '' }}{{ formatCurrency(netPnl) }}
          </span>
          <div class="roi-badge" [ngClass]="netPnl >= 0 ? 'positive' : 'negative'">
            <span class="roi-value">{{ formatPercentage(Math.abs(netRoi)) }}</span>
            <span class="roi-arrow" [ngClass]="netPnl >= 0 ? 'up' : 'down'">
              {{ netPnl >= 0 ? '↗' : '↘' }}
            </span>
          </div>
        </div>
      </div>
      <button class="close-btn" (click)="onClose()">×</button>
    </div>

    <!-- Content -->
    <div class="popup-content">
      <div class="content-header">
        <h3 class="content-title">Trades information</h3>
        <div class="controls">
          <button class="sort-btn" (click)="onSortByTime()">
            <span>Sort by: Time</span>
            <span class="sort-icon">↕</span>
          </button>
          <button class="filter-btn" (click)="onFilter()">
            <span class="filter-icon">⧉</span>
            <span>Filter</span>
          </button>
        </div>
      </div>

      <!-- Trades Table -->
      <div class="trades-table-container">
        <div class="trades-table">
          <div class="table-header">
            <div class="header-cell">Open time</div>
            <div class="header-cell">Ticker</div>
            <div class="header-cell">Side</div>
            <div class="header-cell">P&L</div>
            <div class="header-cell">Followed strategy</div>
            <div class="header-cell">Strategy name</div>
          </div>

          <div class="table-body">
            <div class="table-row" *ngFor="let trade of trades">
              <div class="table-cell time-cell">{{ trade.openTime }}</div>
              <div class="table-cell ticker-cell">
                <span class="ticker-badge">{{ trade.ticker }}</span>
              </div>
              <div class="table-cell side-cell">{{ trade.side }}</div>
              <div class="table-cell pnl-cell" [ngClass]="trade.netPnl >= 0 ? 'positive' : 'negative'">
                <span class="pnl-value">{{ trade.netPnl >= 0 ? '+' : '' }}{{ formatCurrency(trade.netPnl) }}</span>
              </div>
              <div class="table-cell strategy-cell">
                <span 
                  class="strategy-icon" 
                  [ngClass]="trade.followedStrategy ? 'followed' : 'not-followed'"
                ></span>
              </div>
              <div class="table-cell strategy-name-cell">
                <span *ngIf="trade.followedStrategy && trade.strategyName">{{ trade.strategyName }}</span>
                <span *ngIf="!trade.followedStrategy" class="no-strategy">-</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="trades-popup-overlay" *ngIf="visible" (click)="onClose()">
  <div class="trades-popup" (click)="$event.stopPropagation()">
    <!-- Header -->
    <div class="popup-header">
      <div class="header-content">
        <h2 class="popup-title">Trades Information - Pop up</h2>
        <div class="date-info">
          <span class="date">{{ selectedDate }}</span>
          <span class="separator">|</span>
          <span class="net-pnl" [ngClass]="netPnl >= 0 ? 'positive' : 'negative'">
            Net P&L {{ netPnl >= 0 ? '+' : '' }}${{ netPnl.toFixed(2) }}
          </span>
          <div class="roi-badge" [ngClass]="netPnl >= 0 ? 'positive' : 'negative'">
            <span class="roi-value">{{ Math.abs(netRoi).toFixed(1) }}%</span>
            <span class="roi-arrow" [ngClass]="netPnl >= 0 ? 'up' : 'down'">
              {{ netPnl >= 0 ? '↗' : '↘' }}
            </span>
          </div>
        </div>
      </div>
      <button class="close-btn" (click)="onClose()">×</button>
    </div>

    <!-- Content -->
    <div class="popup-content">
      <div class="content-header">
        <h3 class="content-title">Trades information</h3>
        <div class="controls">
          <button class="sort-btn" (click)="onSortByTime()">
            <span>Sort by: Time</span>
            <span class="sort-icon">↕</span>
          </button>
          <button class="filter-btn" (click)="onFilter()">
            <span class="filter-icon">⧉</span>
            <span>Filter</span>
          </button>
        </div>
      </div>

      <!-- Trades Table -->
      <div class="trades-table">
        <div class="table-header">
          <div class="header-cell">Open time</div>
          <div class="header-cell">Ticker</div>
          <div class="header-cell">Side</div>
          <div class="header-cell">Instrument</div>
          <div class="header-cell">Net P&L</div>
          <div class="header-cell">Net ROI</div>
          <div class="header-cell">Followed strategy</div>
          <div class="header-cell">Strategy name</div>
        </div>

        <div class="table-body">
          <div class="table-row" *ngFor="let trade of trades">
            <div class="table-cell time-cell">{{ trade.openTime }}</div>
            <div class="table-cell ticker-cell">
              <span class="ticker-badge" [style.background-color]="getTickerColor(trade.ticker)">
                {{ trade.ticker }}
              </span>
            </div>
            <div class="table-cell side-cell">{{ trade.side }}</div>
            <div class="table-cell instrument-cell">{{ trade.instrument }}</div>
            <div class="table-cell pnl-cell" [ngClass]="trade.netPnl >= 0 ? 'positive' : 'negative'">
              {{ trade.netPnl >= 0 ? '+' : '' }}${{ trade.netPnl.toFixed(2) }}
            </div>
            <div class="table-cell roi-cell">
              {{ trade.netPnl >= 0 ? '' : '(' }}{{ trade.netRoi.toFixed(1) }}%{{ trade.netPnl < 0 ? ')' : '' }}
            </div>
            <div class="table-cell strategy-cell">
              <span 
                class="strategy-icon" 
                [ngClass]="getStrategyIcon(trade.followedStrategy)"
                [style.color]="getStrategyColor(trade.followedStrategy)"
              ></span>
            </div>
            <div class="table-cell strategy-name-cell">{{ trade.strategyName }}</div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

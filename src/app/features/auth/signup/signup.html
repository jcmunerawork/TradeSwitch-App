@if (!showPlanSelection) {
<div class="signup-container">
  <div class="signup-wrapper">

    <div class="signup-header">
      <h1 class="signup-title">Create account</h1>
      <p class="signup-subtitle">Because trading with rules starts right here</p>
    </div>
    @if (currentStep === 1 || isAdminSignup) {
  
    <form [formGroup]="signupForm" (ngSubmit)="onSubmit()" class="signup-form">
      <ng-container>
        <app-text-input
          name="firstName"
          label="First Name"
          placeholder="Your first name here"
          formControlName="firstName"
          class="form-input"
        ></app-text-input>
  
        <app-text-input
          name="lastName"
          label="Last Name"
          placeholder="Your last name here"
          formControlName="lastName"
          class="form-input"
        ></app-text-input>
  
        <app-text-input
          name="email"
          label="Email"
          placeholder="Your email here"
          formControlName="email"
          class="form-input"
          type="email"
        ></app-text-input>
  
        <app-password-input
          label="Password"
          placeholder="Your password here"
          formControlName="password"
          class="form-input"
          [showValidation]="true"
          [userEmail]="signupForm.get('email')?.value || ''"
          [userName]="signupForm.get('firstName')?.value || ''"
        ></app-password-input>
  
        <app-phone-input
          label="Phone number"
          placeholder="Your phone number here"
          formControlName="phoneNumber"
          class="form-input"
        ></app-phone-input>
  
        <app-birthday-input
          label="Birthday"
          placeholder="Your birthday here"
          formControlName="birthday"
          class="form-input"
        ></app-birthday-input>
  
        <button
          type="submit"
          class="submit-button"
        >
          Register
        </button>
        <!-- 
          <div class="signup-methods-separator">
            <span class="separator-line"></span>
            Or sign up with
            <span class="separator-line"></span>
          </div>
    
          <div class="social-buttons-container">
            <button
              class="social-button"
              type="button"
              (click)="signInWithGoogle()"
            >
              <img
                src="assets/google-logo.svg"
                alt="Google logo"
                class="social-icon"
              />
              Google
            </button>
            <button class="social-button" type="button" (click)="signInWithApple()">
              <img
                src="assets/apple-logo.svg"
                alt="Apple logo"
                class="social-icon"
              />
              Apple
            </button>
          </div>
        -->
        @if (!isAdminSignup) {
        <p class="login-text">
          Already have an account? <a routerLink="/login">Log in</a>
        </p>
        }
      </ng-container>
    </form>
    } 
  </div>
</div>
} @else {
<div class="plan-selection-overlay">
  <app-plan-selection 
    [userData]="userData"
    (planSelected)="onPlanSelected($event)"
    (goBack)="onGoBackToSignup()"
  ></app-plan-selection>
</div>

<!-- Stripe loader popup -->
<app-stripe-loader-popup
  [visible]="showStripeLoader"
  [message]="'Redirecting to Stripe...'">
</app-stripe-loader-popup>

<!-- Error popup for Stripe redirection failures -->
@if (showStripeError) {
<div class="cancel-plan-popup">
  <div class="popup-overlay" (click)="closeStripeError()"></div>
  <div class="popup-content">
    <div class="popup-header">
      <h3 class="popup-title">Redirection Error</h3>
      <button class="close-btn" (click)="closeStripeError()">Ã—</button>
    </div>
    
    <div class="popup-body">
      <div class="warning-icon">
        <svg width="48" height="48" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M12 9V13M12 17H12.01M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" stroke="#EF4444" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </div>
      
      <h4 class="warning-title">Unable to redirect to payment</h4>
      <p class="warning-text">
        {{ stripeErrorMessage }}
      </p>
    </div>
    
    <div class="popup-footer">
      <button class="btn-confirm" (click)="closeStripeError()">
        Try Again
      </button>
    </div>
  </div>
</div>
}
}

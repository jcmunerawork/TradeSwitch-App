<div
  class="table-container color-background d-flex flex-col justify-between p-24"
>
  <div class="d-flex flex-col">
    <div class="accounts-header">
      <div class="table-titles">
        <h1 class="subtitle mb-6">Accounts</h1>
      </div>
      <!-- <div class="table-actions-container smallText desktop-actions">
        <div 
          class="search-user-container d-flex items-center p-10 mr-10"
          onmouseover="this.style.border='1px solid rgba(158, 196, 242, 0.2)'"
          onmouseout="this.style.border=''"
          style="cursor: pointer; transition: all 0.2s ease;"
        >
          <label for="search-user" class="mr-10"
            ><span 
              class="material-symbols-outlined color-background"
              style="font-size: 18px;"
            >search</span
          ></label>
          <input
            id="search-account"
            type="text"
            placeholder="Search account"
            [(ngModel)]="searchTerm"
            class="search-box color-background smallText"
          />
        </div>

        <button
          class="sort-Btn regularText color-secondary-300 p-10 mr-10"
          (click)="toggleSort()"
          style="cursor: pointer; transition: all 0.2s ease;"
          onmouseover="this.style.backgroundColor='rgba(158, 196, 242, 0.2)'; this.style.transform='translateY(-1px)'"
          onmouseout="this.style.backgroundColor=''; this.style.transform='translateY(0)'"
        >
          <span 
            class="material-symbols-outlined" 
            style="font-size: 18px; transition: all 0.2s ease;"
            onmouseover="this.style.transform='rotate(180deg)'"
            onmouseout="this.style.transform='rotate(0deg)'"
          >swap_vert</span>
          Sort by: Last Update
        </button>

        <div class="filter-container" #filterContainer>
          <button
            class="filter-btn color-secondary-300 smallText d-flex items-center p-10"
            (click)="openFilter()"
          >
            <span class="material-symbols-outlined color-secondary-300" style="font-size: 18px">filter_alt</span> Filter
          </button>
          @if (showFilter) {
          <div class="filter-modal py-20 px-24 d-flex flex-col">
            <label class="mt-10">Balance:</label>
              <div
                class="percentage-input d-flex items-center justify-between p-10"
              >
                <input
                  id="min-balance"
                  type="text"
                  [(ngModel)]="minBalanceInput"
                  placeholder="Min Balance"
                  class="search-box color-background smallText"
                  (input)="onMinBalanceInput($event)"
                  (focus)="onMinBalanceFocus()"
                  (blur)="onMinBalanceBlur()"
                />
                <label for="min-balance">min $</label>
              </div>

              <div
                class="percentage-input d-flex items-center justify-between p-10"
              >
                <input
                  id="max-balance"
                  type="text"
                  [(ngModel)]="maxBalanceInput"
                  placeholder="Max Balance"
                  class="search-box color-background smallText"
                  (input)="onMaxBalanceInput($event)"
                  (focus)="onMaxBalanceFocus()"
                  (blur)="onMaxBalanceBlur()"
                />
                <label for="max-balance">max $</label>
              </div>
            <button
              class="filter-btn p-10 bg-primary-400 color-bg-black inputText"
              (click)="apply()"
              style="cursor: pointer; transition: all 0.2s ease;"
              onmouseover="this.style.backgroundColor='#8AE01A'; this.style.transform='translateY(-1px)'; this.style.boxShadow='0 4px 8px rgba(155, 245, 38, 0.3)'"
              onmouseout="this.style.backgroundColor=''; this.style.transform='translateY(0)'; this.style.boxShadow=''"
            >
              Apply
            </button>
          </div>
          }
        </div>

      </div>-->
      
      <!-- Mobile Actions -->
      <div class="mobile-actions">
        <div 
          class="search-user-container d-flex items-center p-10"
          onmouseover="this.style.border='1px solid rgba(158, 196, 242, 0.2)'"
          onmouseout="this.style.border=''"
          style="cursor: pointer; transition: all 0.2s ease;"
        >
          <label for="search-user" class="mr-10"
            ><span 
              class="material-symbols-outlined color-background"
              style="font-size: 18px;"
            >search</span
          ></label>
          <input
            id="search-account-mobile"
            type="text"
            placeholder="Search account"
            [(ngModel)]="searchTerm"
            class="search-box color-background smallText"
          />
        </div>
        
        <div class="mobile-controls-row">
          <button
            class="sort-Btn regularText color-secondary-300 p-10"
            (click)="toggleSort()"
            style="cursor: pointer; transition: all 0.2s ease;"
            onmouseover="this.style.backgroundColor='rgba(158, 196, 242, 0.2)'; this.style.transform='translateY(-1px)'"
            onmouseout="this.style.backgroundColor=''; this.style.transform='translateY(0)'"
          >
            <span 
              class="material-symbols-outlined" 
              style="font-size: 18px; transition: all 0.2s ease;"
              onmouseover="this.style.transform='rotate(180deg)'"
              onmouseout="this.style.transform='rotate(0deg)'"
            >swap_vert</span>
            Sort by: Last Update
          </button>

          <div class="filter-container" #filterContainer>
            <button
              class="filter-btn color-secondary-300 smallText d-flex items-center p-10"
              (click)="openFilter()"
            >
              <span class="material-symbols-outlined color-secondary-300" style="font-size: 18px">filter_alt</span> Filter
            </button>
            @if (showFilter) {
            <div class="filter-modal py-20 px-24 d-flex flex-col">
              <label class="mt-10">Balance:</label>
              <div
                class="percentage-input d-flex items-center justify-between p-10"
              >
                <input
                  id="min-balance-mobile"
                  type="text"
                  [(ngModel)]="minBalanceInput"
                  placeholder="Min Balance"
                  class="search-box color-background smallText"
                  (input)="onMinBalanceInput($event)"
                  (focus)="onMinBalanceFocus()"
                  (blur)="onMinBalanceBlur()"
                />
                <label for="min-balance-mobile">min $</label>
              </div>

              <div
                class="percentage-input d-flex items-center justify-between p-10"
              >
                <input
                  id="max-balance-mobile"
                  type="text"
                  [(ngModel)]="maxBalanceInput"
                  placeholder="Max Balance"
                  class="search-box color-background smallText"
                  (input)="onMaxBalanceInput($event)"
                  (focus)="onMaxBalanceFocus()"
                  (blur)="onMaxBalanceBlur()"
                />
                <label for="max-balance-mobile">max $</label>
              </div>
              <button
                class="filter-btn p-10 bg-primary-400 color-bg-black inputText"
                (click)="apply()"
                style="cursor: pointer; transition: all 0.2s ease;"
                onmouseover="this.style.backgroundColor='#8AE01A'; this.style.transform='translateY(-1px)'; this.style.boxShadow='0 4px 8px rgba(155, 245, 38, 0.3)'"
                onmouseout="this.style.backgroundColor=''; this.style.transform='translateY(0)'; this.style.boxShadow=''"
              >
                Apply
              </button>
            </div>
            }
          </div>
        </div>
      </div>
    </div>
    <div class="table-scroll-container">
      <table class="regularText">
        <thead>
          <tr>
            <th class="regularText py-18">Account Name</th>
            <th class="regularText py-18">Broker</th>
            <th class="regularText py-18">Server</th>
            <th class="regularText py-18">Balance</th>
            <th class="regularText py-18">Profit calculation</th>
            <th class="regularText py-18">Last update</th>
            <!--
              <th class="regularText py-18">File upload</th>
              <th class="regularText py-18">Clear trades</th>
            -->
            <th class="regularText py-18">Edit account</th>
            <th class="regularText py-18">Delete account</th>
          </tr>
        </thead>
        <tbody>
          @for (account of filteredUsers; track $index) {
          <tr>
            <td class="smallText">
              <div class="d-flex items-center gap-8">
                <p>{{ account.accountName }}</p>
              </div>
            </td>
            <td class="smallText">
              <div class="d-flex items-center gap-8">
                <p>{{ account.broker }}</p>
              </div>
            </td>
            <td class="smallText">
              <div class="d-flex items-center gap-8">
                <p>{{ account.server }}</p>
              </div>
            </td>
            <td class="smallText">
              <p *ngIf="account.balance !== undefined">
                {{ account.balance | currency : "USD" : "symbol" }}
              </p>
              <p *ngIf="account.balance === undefined" class="loading-text">
                Loading...
              </p>
            </td>
            <td class="smallText">
              <p>FIFO</p>
            </td>
            <td class="smallText">
              <p>
                {{ account.createdAt.toDate() | date : "MM/dd/yyyy h:mm a" }}
              </p>
            </td>
            <!--
              <td class="smallText">
                <span 
                  class="material-symbols-outlined color-secondary-500" 
                  title="Upload" 
                  style="font-size: 24px; cursor: pointer; transition: all 0.2s ease;"
                  onmouseover="this.style.transform='scale(1.2)'; this.style.opacity='0.8'"
                  onmouseout="this.style.transform='scale(1)'; this.style.opacity='1'"
                >upload</span>
              </td>
              <td class="smallText">
                <span 
                  class="material-symbols-outlined color-red" 
                  title="Clear trades" 
                  style="font-size: 24px; cursor: pointer; transition: all 0.2s ease;"
                  onmouseover="this.style.transform='scale(1.2)'; this.style.opacity='0.8'"
                  onmouseout="this.style.transform='scale(1)'; this.style.opacity='1'"
                >cancel</span>
              </td>
            -->
            <td class="smallText">
              <span 
                (click)="editAccount(account)"
                class="material-symbols-outlined color-secondary-500" 
                style="font-size: 24px; cursor: pointer; transition: all 0.2s ease;" 
                title="Edit account"
                onmouseover="this.style.transform='scale(1.2)'; this.style.opacity='0.8'"
                onmouseout="this.style.transform='scale(1)'; this.style.opacity='1'"
              >edit</span>
            </td>
            <td class="smallText">
              <span
                (click)="deleteAccount(account)"
                class="material-symbols-outlined color-red"
                style="font-size: 24px; cursor: pointer; transition: all 0.2s ease;"
                title="Delete account"
                onmouseover="this.style.transform='scale(1.2)'; this.style.opacity='0.8'"
                onmouseout="this.style.transform='scale(1)'; this.style.opacity='1'"
              >delete</span>
            </td>
          </tr>
          }
        </tbody>
      </table>
    </div>
  </div>
</div>

@if(showConfirmation){
<app-show-confirmation
  [account]="accountToDelete"
  (confirm)="confirmDelete()"
  (cancel)="cancelDelete()"
  message="Are you sure you want to delete this account?"
></app-show-confirmation>
}

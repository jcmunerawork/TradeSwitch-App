import './polyfills.server.mjs';
import{a as $}from"./chunk-VTRHHDOS.mjs";import{i as B}from"./chunk-6SLXWV7I.mjs";import{a as ae}from"./chunk-ZQTEKPLK.mjs";import"./chunk-4QIT3UAD.mjs";import{a as ye,b as Oe}from"./chunk-HKPG3D22.mjs";import{a as we}from"./chunk-5ISIK2WD.mjs";import{a as ve,b as Me}from"./chunk-PUENJBJ5.mjs";import"./chunk-DPLNUI4A.mjs";import{c as ge,e as M,f as fe,g as he,j as Pe,m as _e,n as be,u as Ce,w as xe}from"./chunk-ZUEZAN7G.mjs";import{q as oe}from"./chunk-5EV7JWWV.mjs";import{a as q}from"./chunk-SS4N7RKX.mjs";import{b as D,c as J,d as pe,e as U,f as z,j as k,p as me,q as Ae,r as ue,u as Ne,v as j}from"./chunk-YWJXSM6M.mjs";import{$ as y,Ab as v,Cb as h,Eb as c,Ka as l,Pa as w,Pb as x,Rb as o,Sb as E,Tb as u,Va as T,W as Q,Yc as re,_ as X,_a as C,ea as _,fa as b,ga as ee,gd as A,ha as te,lb as O,ld as ie,mb as S,nb as V,ob as L,pb as R,qb as p,rb as r,sb as i,tb as f,za as ne,zd as N}from"./chunk-YCCZPWYV.mjs";import{Ea as de,S as se,ba as le,bb as Te,sa as ce}from"./chunk-RF6MMMYN.mjs";import{a as W,b as Z,k as g}from"./chunk-H4UZCO6D.mjs";var Se={currentPlan:"Pro Plan",renewalDate:"2025-08-27",remainingUntilRenewal:"16 days",price:250,activationFee:null,billingCycle:"Monthly"},Ee=[{name:"Free",price:0,period:"/month",icon:"circle",color:"#4b7ee8",features:[{label:"Trading Accounts",value:"1"},{label:"Consistency Rules",value:"YES"},{label:"Trading Journal",value:"YES"},{label:"Live Statistics",value:"YES"}],cta:"Change Plan"},{name:"Starter",price:35,period:"/month",icon:"circle",color:"#4b7ee8",features:[{label:"Trading Accounts",value:"2"},{label:"Consistency Rules",value:"YES"},{label:"Trading Journal",value:"YES"},{label:"Live Statistics",value:"YES"}],cta:"Change Plan"},{name:"Pro",price:99,period:"/month",mostPopular:!0,icon:"square",color:"#d1ff81",features:[{label:"Trading Accounts",value:"6"},{label:"Consistency Rules",value:"YES"},{label:"Trading Journal",value:"YES"},{label:"Live Statistics",value:"YES"}],cta:"Get Starter Now"}];function Ve(s,t){s&1&&(r(0,"div",29)(1,"span"),o(2,"Your Current Plan"),i()())}function Le(s,t){if(s&1){let e=v();r(0,"div",28),O(1,Ve,3,0,"div",29),r(2,"div",30)(3,"h3",31),o(4),i(),r(5,"div",32)(6,"span",33),o(7),i(),r(8,"span",34),o(9,"/month"),i()()(),r(10,"div",35)(11,"div",36)(12,"span",37),o(13),i()(),r(14,"div",36)(15,"span",37),o(16),i()(),r(17,"div",36)(18,"span",38),o(19,"\u2713"),i()(),r(20,"div",36)(21,"span",38),o(22,"\u2713"),i()(),r(23,"div",36)(24,"span",38),o(25,"\u2713"),i()()(),r(26,"div",39)(27,"button",40),h("click",function(){let a=_(e).$implicit,m=c(2);return b(m.onPlanChange(a))}),o(28),i()()()}if(s&2){let e=t.$implicit,n=c(2);x("current-plan",n.isCurrentPlan(e.name)),l(),S(n.isCurrentPlan(e.name)?1:-1),l(3),E(e.name),l(3),u("$",e.price),l(6),E(n.getTradingAccounts(e.name)),l(3),E(n.getStrategies(e.name)),l(11),x("current-plan-button",n.isCurrentPlan(e.name)),p("disabled",n.isCurrentPlan(e.name)),l(),u(" ",n.getButtonText(e.name)," ")}}function Re(s,t){if(s&1){let e=v();r(0,"div",27)(1,"div",41),h("click",function(){_(e);let a=c(2);return b(a.cancelCancelPlan())}),i(),r(2,"div",42)(3,"div",43)(4,"h3",44),o(5,"Cancel Membership"),i(),r(6,"button",45),h("click",function(){_(e);let a=c(2);return b(a.cancelCancelPlan())}),o(7,"\xD7"),i()(),r(8,"div",46)(9,"div",47),ee(),r(10,"svg",48),f(11,"path",49),i()(),te(),r(12,"h4",50),o(13,"Are you sure you want to cancel your membership?"),i(),r(14,"p",51),o(15," This action will immediately cancel your current plan and you will lose access to all premium features. This action cannot be undone. "),i(),r(16,"div",52)(17,"p",53),o(18,"Current Plan:"),i(),r(19,"p",31),o(20),i()()(),r(21,"div",54)(22,"button",55),h("click",function(){_(e);let a=c(2);return b(a.cancelCancelPlan())}),o(23," Keep Membership "),i(),r(24,"button",56),h("click",function(){_(e);let a=c(2);return b(a.confirmCancelPlan())}),o(25," Yes, Cancel Plan "),i()()()()}if(s&2){let e=c(2);l(20),E((e.userPlan==null?null:e.userPlan.name)||"Unknown Plan")}}function je(s,t){if(s&1){let e=v();r(0,"div",1)(1,"h1",2),o(2,"Membership details"),i(),r(3,"h3",3),o(4," Here you can view the details of your current membership. "),i()(),r(5,"div",4)(6,"div",5)(7,"div",6)(8,"div",7)(9,"span",8),o(10,"Current Plan"),i(),r(11,"span",9),o(12),i()(),r(13,"div",7)(14,"span",8),o(15,"Renewal date"),i(),r(16,"span",9),o(17),i()(),r(18,"div",7)(19,"span",8),o(20,"Remaining until renewal"),i(),r(21,"span",9),o(22),i()()(),r(23,"div",6)(24,"div",7)(25,"span",8),o(26,"Price"),i(),r(27,"span",9),o(28),i()(),r(29,"div",7)(30,"span",8),o(31,"Activation Fee"),i(),r(32,"span",9),o(33,"N/A"),i()(),r(34,"div",7)(35,"span",8),o(36,"Billing cycle"),i(),r(37,"span",9),o(38,"Monthly"),i()()()()(),r(39,"div",1)(40,"h1",2),o(41,"Plan benefits"),i(),r(42,"h3",3),o(43," Here's a quick look at what's included in your current plan. "),i()(),r(44,"div",10)(45,"div",11)(46,"div",12),f(47,"div",13),r(48,"span",14),o(49),i()(),r(50,"div",12),f(51,"div",13),r(52,"span",14),o(53,"Consistency rules"),i()(),r(54,"div",12),f(55,"div",13),r(56,"span",14),o(57),i()(),r(58,"div",12),f(59,"div",13),r(60,"span",14),o(61,"Trading journal"),i()(),r(62,"div",12),f(63,"div",13),r(64,"span",14),o(65,"Live Statistics"),i()()()(),r(66,"div",15)(67,"div",16)(68,"h1",17),o(69,"Compare plans"),i(),r(70,"h3",3),o(71,"Choose a membership that's right for you"),i()(),r(72,"button",18),h("click",function(){_(e);let a=c();return b(a.onManageSubscription())}),o(73,"Manage Subscription"),i()(),r(74,"div",19)(75,"div",20)(76,"div",21)(77,"div",22)(78,"h3",23),o(79,"Benefits"),i()(),r(80,"div",24)(81,"div",12),o(82,"Trading Accounts"),i(),r(83,"div",12),o(84,"Strategies"),i(),r(85,"div",12),o(86,"Consistency Rules"),i(),r(87,"div",12),o(88,"Trading Journal"),i(),r(89,"div",12),o(90,"Live Statistics"),i()()(),r(91,"div",25),L(92,Le,29,11,"div",26,V),i()()(),O(94,Re,26,1,"div",27)}if(s&2){let e=c();l(12),E((e.userPlan==null?null:e.userPlan.name)||"Free Plan"),l(5),E(e.renewalDate),l(5),u("",e.remainingDays," days"),l(6),u("$",(e.userPlan==null?null:e.userPlan.price)||"0.00"),l(21),u("Trading accounts: ",(e.userPlan==null?null:e.userPlan.tradingAccounts)||1),l(8),u("Strategies: ",(e.userPlan==null?null:e.userPlan.strategies)||1),l(35),R(e.plansData),l(2),S(e.showCancelPlanProcessing?94:-1)}}function qe(s,t){if(s&1){let e=v();r(0,"app-subscription-processing",57),h("paymentSuccess",function(){_(e);let a=c();return b(a.onPaymentProcessingSuccess())})("paymentError",function(){_(e);let a=c();return b(a.onPaymentProcessingError())})("goBack",function(){_(e);let a=c();return b(a.onPaymentProcessingGoBack())}),i()}if(s&2){let e=c();p("config",e.subscriptionProcessingConfig)}}function $e(s,t){if(s&1){let e=v();r(0,"app-order-summary",58),h("continue",function(){_(e);let a=c();return b(a.onOrderSummaryContinue())}),i()}if(s&2){let e=c();p("config",e.orderSummaryConfig)}}var G=class s{constructor(t,e,n){this.store=t;this.strategySvc=e;this.reportSvc=n}planDetails=null;plansData=[];userPlan=void 0;renewalDate="";remainingDays=0;user=null;selectedIndex=0;tabs=[{label:"Profile Details"},{label:"Plan Management"},{label:"Billing Management"}];showSubscriptionProcessing=!1;showOrderSummary=!1;selectedPlanForChange=null;currentPaymentId="";showCancelPlanProcessing=!1;subscriptionProcessingConfig={paymentId:"",userId:"",context:"plan-change",planName:""};orderSummaryConfig={context:"plan-change",planName:"",price:0};subscriptionService=y(ve);planService=y(Me);authService=y(q);ngOnInit(){return g(this,null,function*(){this.plansData=Ee,this.loadUserPlan()})}loadUserPlan(){return g(this,null,function*(){try{if(this.getUserData(),!this.user){console.error("\u274C User not found");return}let t=yield this.subscriptionService.getAllSubscriptionsByUserId(this.user.id);if(t&&t.length>0){let e=t[0],n=yield this.planService.getPlanById(e.planId);n?(this.userPlan=n,this.calculateRenewalDate(e.created_at)):this.setDefaultFreePlan()}else this.setDefaultFreePlan()}catch(t){console.error("Error loading user plan:",t),this.setDefaultFreePlan()}})}getUserData(){this.store.select(ae).subscribe({next:t=>{this.user=t.user},error:t=>{console.error("Error fetching user data",t)}})}setDefaultFreePlan(){this.userPlan={id:"free",name:"Free",price:"0",strategies:1,tradingAccounts:1,createdAt:new Date,updatedAt:new Date},this.calculateRenewalDate(new Date)}calculateRenewalDate(t){let e;t?e=t.toDate?t.toDate():new Date(t):e=new Date;let n=new Date(e.getTime()+30*24*60*60*1e3);this.renewalDate=n.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});let a=new Date,m=n.getTime()-a.getTime();this.remainingDays=Math.ceil(m/(1e3*3600*24)),this.remainingDays<0&&(this.remainingDays=0)}selectTypeData(t){this.selectedIndex=t}isCurrentPlan(t){return this.userPlan?this.userPlan.name.toLowerCase().includes(t.toLowerCase())||t==="Free"&&this.userPlan.name.toLowerCase().includes("free"):!1}getTradingAccounts(t){return{Free:"1",Starter:"2",Pro:"6"}[t]||"1"}getStrategies(t){return{Free:"1",Starter:"3",Pro:"8"}[t]||"1"}getButtonText(t){return this.isCurrentPlan(t)?"Current Plan":"Change Plan"}onPlanChange(t){return g(this,null,function*(){if(!this.isCurrentPlan(t.name))try{this.selectedPlanForChange=t,this.subscriptionProcessingConfig={paymentId:"",userId:this.user?.id||"",context:"plan-change",planName:t.name},this.orderSummaryConfig={context:"plan-change",planName:t.name,price:t.price},this.showSubscriptionProcessing=!0,setTimeout(()=>{this.simulateSubscriptionProcessing()},1e3)}catch(e){console.error("Error iniciando cambio de plan:",e),alert("Error starting plan change. Please try again.")}})}simulateSubscriptionProcessing(){setTimeout(()=>g(this,null,function*(){try{Math.random()>.2?(yield this.createNewSubscription(),this.onPaymentSuccess()):this.onPaymentError()}catch(t){console.error("Error creando nueva suscripci\xF3n:",t),this.onPaymentError()}}),5e3)}onPaymentSuccess(){this.showSubscriptionProcessing=!1,this.showOrderSummary=!0}onPaymentError(){this.showSubscriptionProcessing=!1,alert("Error processing plan change. Please try again.")}onPaymentProcessingSuccess(){this.showSubscriptionProcessing=!1,this.showOrderSummary=!0}onPaymentProcessingError(){this.showSubscriptionProcessing=!1,alert("Error processing plan change. Please try again.")}onPaymentProcessingGoBack(){this.showSubscriptionProcessing=!1}onOrderSummaryContinue(){this.showOrderSummary=!1,alert("Plan change completed successfully!"),this.loadUserPlan()}onCancelPlan(){this.showCancelPlanProcessing=!0}confirmCancelPlan(){return g(this,null,function*(){if(!this.user){console.error("\u274C User not found");return}try{let t=yield this.subscriptionService.getAllSubscriptionsByUserId(this.user.id);if(t&&t.length>0){let e=t[0];yield this.subscriptionService.updateSubscription(this.user.id,e.id,{status:"cancelled",planId:""}),alert("Your plan has been cancelled successfully."),yield this.loadUserPlan()}else alert("No active subscription found to cancel.")}catch(t){console.error("\u274C Error cancelando plan:",t),alert("Error cancelling plan. Please try again.")}finally{this.showCancelPlanProcessing=!1}})}cancelCancelPlan(){this.showCancelPlanProcessing=!1}createNewSubscription(){return g(this,null,function*(){})}onManageSubscription(){return g(this,null,function*(){let t=yield this.authService.getBearerTokenFirebase(this.user?.id||""),e=yield fetch("https://trade-manager-backend-836816769157.us-central1.run.app/payments/create-portal-session",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({userId:this.user?.id})});if(!e.ok)throw new Error("Error creating portal session");let n=yield e.json(),a=n.body?.url||n.url;if(!a)throw new Error("Portal session URL not found in response");window.open(a,"_blank")})}static \u0275fac=function(e){return new(e||s)(w(N),w($),w(B))};static \u0275cmp=T({type:s,selectors:[["app-plan-settings"]],inputs:{planDetails:"planDetails"},decls:3,vars:3,consts:[[3,"config"],[1,"main-titles","color-background","d-flex","flex-col","mb-24"],[1,"subtitle","mb-8"],[1,"regularText"],[1,"membership-details-section"],[1,"membership-info"],[1,"info-column"],[1,"info-item"],[1,"info-label"],[1,"info-value"],[1,"plan-benefits-section"],[1,"benefits-list"],[1,"benefit-item"],[1,"benefit-checkbox","checked"],[1,"benefit-text"],[1,"main-titles","color-background","mb-30"],[1,"d-flex","flex-col"],[1,"subtitle","mb-12"],[1,"manage-subscription-btn","regularText","signUp",3,"click"],[1,"plan-comparison-section"],[1,"comparison-table"],[1,"benefits-column"],[1,"benefits-header"],[1,"benefits-title"],[1,"benefits-text-list"],[1,"plans-container"],[1,"plan-card",3,"current-plan"],[1,"cancel-plan-popup"],[1,"plan-card"],[1,"current-plan-badge"],[1,"plan-header"],[1,"plan-name"],[1,"plan-price"],[1,"price"],[1,"period"],[1,"plan-features"],[1,"feature-row"],[1,"feature-value"],[1,"feature-check"],[1,"plan-footer"],[1,"plan-button",3,"click","disabled"],[1,"popup-overlay",3,"click"],[1,"popup-content"],[1,"popup-header"],[1,"popup-title"],[1,"close-btn",3,"click"],[1,"popup-body"],[1,"warning-icon"],["width","48","height","48","viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M12 9V13M12 17H12.01M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z","stroke","#F59E0B","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],[1,"warning-title"],[1,"warning-text"],[1,"current-plan-info"],[1,"plan-label"],[1,"popup-footer"],[1,"btn-cancel",3,"click"],[1,"btn-confirm",3,"click"],[3,"paymentSuccess","paymentError","goBack","config"],[3,"continue","config"]],template:function(e,n){e&1&&(O(0,je,95,7),O(1,qe,1,1,"app-subscription-processing",0),O(2,$e,1,1,"app-order-summary",0)),e&2&&(S(!n.showSubscriptionProcessing&&!n.showOrderSummary?0:-1),l(),S(n.showSubscriptionProcessing?1:-1),l(),S(n.showOrderSummary?2:-1))},dependencies:[A,ye,Oe],styles:['.membership-details-section[_ngcontent-%COMP%]{margin-bottom:3rem}.membership-info[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:2rem;align-items:center}.info-column[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.5rem;flex:1}.info-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.15rem;font-family:SF Pro Display}.info-label[_ngcontent-%COMP%]{font-size:.875rem;font-weight:500;color:#a0a0a0;margin-bottom:.25rem}.info-value[_ngcontent-%COMP%]{font-size:1rem;font-weight:700;color:#fff}.plan-benefits-section[_ngcontent-%COMP%]{margin-bottom:3rem}.benefit-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;font-family:SF Pro Display}.benefit-checkbox[_ngcontent-%COMP%]{width:24px;height:24px;border-radius:4px;display:flex;align-items:center;justify-content:center;background:#4a4a4a;border:1px solid #666}.benefit-checkbox.checked[_ngcontent-%COMP%]{background:#5186e4;border-color:#1d274e;position:relative}.benefit-checkbox.checked[_ngcontent-%COMP%]:after{content:"";display:block;width:6px;height:10px;border:2px solid #1D274E;border-top:none;border-left:none;transform:rotate(45deg);position:absolute}.benefit-text[_ngcontent-%COMP%]{font-size:1rem;color:#fff;font-weight:500}@media (max-width: 768px){.membership-info[_ngcontent-%COMP%]{grid-template-columns:1fr}.membership-card[_ngcontent-%COMP%], .benefits-card[_ngcontent-%COMP%]{padding:1.5rem}}.main-titles[_ngcontent-%COMP%]{gap:.5rem;display:flex;align-items:start;justify-content:space-between}.manage-subscription-btn[_ngcontent-%COMP%]{color:#222325;border-radius:.375rem;background:#9bf526;border:none;width:fit-content;padding:.625rem}.manage-subscription-btn[_ngcontent-%COMP%]:hover{background:#4a7717}.fake-checkbox-row[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.fake-checkbox[_ngcontent-%COMP%]{width:20px;height:20px;border-radius:4px;display:flex;align-items:center;justify-content:center}.fake-checkbox.checked[_ngcontent-%COMP%]{background:#4181f7;position:relative}.fake-checkbox.checked[_ngcontent-%COMP%]:after{content:"";display:block;width:10px;height:6px;border-left:2px solid #1d274e;border-bottom:2px solid #1d274e;transform:rotate(-45deg);position:absolute;left:4px;top:4px}.plans-list[_ngcontent-%COMP%]{align-content:flex-start;gap:3.5rem;flex-wrap:wrap}.plans-list[_ngcontent-%COMP%]   .plan-card[_ngcontent-%COMP%]{gap:32px;min-width:28.5rem;border-radius:.5rem;border:.5px solid #4a4a4a;background:radial-gradient(circle at top center,#5186e41a,#5186e403 50%),#151516}.plans-list[_ngcontent-%COMP%]   .plan-card.isMostPopular[_ngcontent-%COMP%]{background:radial-gradient(circle at top center,#bcfe631a,#bcfe6303 50%)}.plans-list[_ngcontent-%COMP%]   .plan-card[_ngcontent-%COMP%]   .plan-card-header[_ngcontent-%COMP%]{gap:1rem;width:100%}.plans-list[_ngcontent-%COMP%]   .plan-card[_ngcontent-%COMP%]   .plan-card-header[_ngcontent-%COMP%]   .card-icon[_ngcontent-%COMP%]{border-radius:8.235px}.plans-list[_ngcontent-%COMP%]   .plan-card[_ngcontent-%COMP%]   .plan-card-header[_ngcontent-%COMP%]   .card-icon.isSquare[_ngcontent-%COMP%]{background-color:#bcfe6333}.plans-list[_ngcontent-%COMP%]   .plan-card[_ngcontent-%COMP%]   .plan-card-header[_ngcontent-%COMP%]   .card-icon.isCircle[_ngcontent-%COMP%]{background-color:#5186e433}.plans-list[_ngcontent-%COMP%]   .plan-card[_ngcontent-%COMP%]   .plan-card-header[_ngcontent-%COMP%]   .card-icon[_ngcontent-%COMP%]   .square-icon[_ngcontent-%COMP%]{width:48px;height:48px;border:5px solid #bcfe63;border-radius:15px}.plans-list[_ngcontent-%COMP%]   .plan-card[_ngcontent-%COMP%]   .plan-card-header[_ngcontent-%COMP%]   .card-icon[_ngcontent-%COMP%]   .circle-icon[_ngcontent-%COMP%]{width:48px;height:48px;border:5px solid #5186e4;border-radius:50%}.plans-list[_ngcontent-%COMP%]   .plan-card[_ngcontent-%COMP%]   .plan-card-header[_ngcontent-%COMP%]   .popular[_ngcontent-%COMP%]{background:#14ae5c26;border-radius:.25rem;color:#14ae5c}.plans-list[_ngcontent-%COMP%]   .plan-card[_ngcontent-%COMP%]   .plan-features[_ngcontent-%COMP%]{width:100%}.plans-list[_ngcontent-%COMP%]   .plan-card[_ngcontent-%COMP%]   .plan-features[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0;gap:2.1875rem;width:100%}.plans-list[_ngcontent-%COMP%]   .plan-card[_ngcontent-%COMP%]   .plan-features[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%], .plans-list[_ngcontent-%COMP%]   .plan-card[_ngcontent-%COMP%]   .plan-card-footer[_ngcontent-%COMP%]{width:100%}.plans-list[_ngcontent-%COMP%]   .plan-card[_ngcontent-%COMP%]   .plan-card-footer[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]{color:#222325;border-radius:.375rem;background:#9bf526;border:none;width:100%;padding:.625rem}.cancel-plan-popup[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;z-index:1000;display:flex;align-items:center;justify-content:center;font-family:SF Pro Display}.cancel-plan-popup[_ngcontent-%COMP%]   .popup-overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;background:#00000080;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px)}.cancel-plan-popup[_ngcontent-%COMP%]   .popup-content[_ngcontent-%COMP%]{position:relative;background:#1a1a1a;border-radius:12px;border:1px solid #333;max-width:480px;width:90%;max-height:90vh;overflow-y:auto;box-shadow:0 20px 25px -5px #0000001a,0 10px 10px -5px #0000000a}.cancel-plan-popup[_ngcontent-%COMP%]   .popup-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:24px 24px 16px;border-bottom:1px solid #333}.cancel-plan-popup[_ngcontent-%COMP%]   .popup-header[_ngcontent-%COMP%]   .popup-title[_ngcontent-%COMP%]{font-size:20px;font-weight:600;color:#fff;margin:0}.cancel-plan-popup[_ngcontent-%COMP%]   .popup-header[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]{background:none;border:none;color:#999;font-size:24px;cursor:pointer;padding:0;width:32px;height:32px;display:flex;align-items:center;justify-content:center;border-radius:6px;transition:all .2s ease}.cancel-plan-popup[_ngcontent-%COMP%]   .popup-header[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]:hover{background:#333;color:#fff}.cancel-plan-popup[_ngcontent-%COMP%]   .popup-body[_ngcontent-%COMP%]{padding:24px;text-align:center}.cancel-plan-popup[_ngcontent-%COMP%]   .popup-body[_ngcontent-%COMP%]   .warning-icon[_ngcontent-%COMP%]{margin-bottom:16px;display:flex;justify-content:center}.cancel-plan-popup[_ngcontent-%COMP%]   .popup-body[_ngcontent-%COMP%]   .warning-title[_ngcontent-%COMP%]{font-size:18px;font-weight:600;color:#fff;margin:0 0 12px}.cancel-plan-popup[_ngcontent-%COMP%]   .popup-body[_ngcontent-%COMP%]   .warning-text[_ngcontent-%COMP%]{color:#999;font-size:14px;line-height:1.5;margin:0 0 20px}.cancel-plan-popup[_ngcontent-%COMP%]   .popup-body[_ngcontent-%COMP%]   .current-plan-info[_ngcontent-%COMP%]{background:#2a2a2a;border-radius:8px;padding:16px;border:1px solid #333}.cancel-plan-popup[_ngcontent-%COMP%]   .popup-body[_ngcontent-%COMP%]   .current-plan-info[_ngcontent-%COMP%]   .plan-label[_ngcontent-%COMP%]{color:#999;font-size:12px;margin:0 0 4px;text-transform:uppercase;letter-spacing:.5px}.cancel-plan-popup[_ngcontent-%COMP%]   .popup-body[_ngcontent-%COMP%]   .current-plan-info[_ngcontent-%COMP%]   .plan-name[_ngcontent-%COMP%]{color:#fff;font-size:16px;font-weight:600;margin:0}.cancel-plan-popup[_ngcontent-%COMP%]   .popup-footer[_ngcontent-%COMP%]{display:flex;gap:12px;padding:0 24px 24px}.cancel-plan-popup[_ngcontent-%COMP%]   .popup-footer[_ngcontent-%COMP%]   .btn-cancel[_ngcontent-%COMP%], .cancel-plan-popup[_ngcontent-%COMP%]   .popup-footer[_ngcontent-%COMP%]   .btn-confirm[_ngcontent-%COMP%]{flex:1;padding:12px 24px;border-radius:8px;font-weight:600;font-size:14px;transition:all .2s ease;border:none;cursor:pointer}.cancel-plan-popup[_ngcontent-%COMP%]   .popup-footer[_ngcontent-%COMP%]   .btn-cancel[_ngcontent-%COMP%]{background:#333;color:#fff;border:1px solid #444}.cancel-plan-popup[_ngcontent-%COMP%]   .popup-footer[_ngcontent-%COMP%]   .btn-cancel[_ngcontent-%COMP%]:hover{background:#444}.cancel-plan-popup[_ngcontent-%COMP%]   .popup-footer[_ngcontent-%COMP%]   .btn-confirm[_ngcontent-%COMP%]{background:#dc2626;color:#fff}.cancel-plan-popup[_ngcontent-%COMP%]   .popup-footer[_ngcontent-%COMP%]   .btn-confirm[_ngcontent-%COMP%]:hover{background:#b91c1c}@media (max-width: 768px){.cancel-plan-popup[_ngcontent-%COMP%]   .popup-content[_ngcontent-%COMP%]{width:95%;margin:20px}.cancel-plan-popup[_ngcontent-%COMP%]   .popup-header[_ngcontent-%COMP%], .cancel-plan-popup[_ngcontent-%COMP%]   .popup-body[_ngcontent-%COMP%], .cancel-plan-popup[_ngcontent-%COMP%]   .popup-footer[_ngcontent-%COMP%]{padding-left:20px;padding-right:20px}.cancel-plan-popup[_ngcontent-%COMP%]   .popup-footer[_ngcontent-%COMP%]{flex-direction:column}.cancel-plan-popup[_ngcontent-%COMP%]   .popup-footer[_ngcontent-%COMP%]   .btn-cancel[_ngcontent-%COMP%], .cancel-plan-popup[_ngcontent-%COMP%]   .popup-footer[_ngcontent-%COMP%]   .btn-confirm[_ngcontent-%COMP%]{width:100%}}.access-buttons[_ngcontent-%COMP%]{gap:1rem}.access-buttons[_ngcontent-%COMP%]   .access-btn[_ngcontent-%COMP%]{padding:.625rem;text-align:center;border-radius:.375rem;width:5.625rem;border:none;width:fit-content;cursor:pointer}.access-buttons[_ngcontent-%COMP%]   .access-btn.signUp[_ngcontent-%COMP%]{border:1px solid #FF3B30;color:#ff3b30;background:none}.access-buttons[_ngcontent-%COMP%]   .access-btn.login[_ngcontent-%COMP%]{background:#9bf526;color:#222325}.plan-comparison-section[_ngcontent-%COMP%]{margin-bottom:3rem;font-family:SF Pro Display;padding-right:1.5rem}.comparison-table[_ngcontent-%COMP%]{display:flex;gap:0;overflow:hidden}@media (max-width: 1200px){.comparison-table[_ngcontent-%COMP%]{overflow-x:auto;gap:1rem}}.benefits-column[_ngcontent-%COMP%]{flex:0 0 200px;padding:7rem 1.5rem 3rem}@media (max-width: 1200px){.benefits-column[_ngcontent-%COMP%]{flex:0 0 180px;padding:5rem 1rem 2rem}}@media (max-width: 768px){.benefits-column[_ngcontent-%COMP%]{flex:0 0 160px;padding:3rem .75rem 1.5rem}}.benefits-header[_ngcontent-%COMP%]{margin-bottom:2rem}@media (max-width: 1200px){.benefits-header[_ngcontent-%COMP%]{margin-bottom:1.5rem}}@media (max-width: 768px){.benefits-header[_ngcontent-%COMP%]{margin-bottom:1rem}}.benefits-title[_ngcontent-%COMP%]{font-size:1.125rem;font-weight:600;color:#fff;margin:0}@media (max-width: 1200px){.benefits-title[_ngcontent-%COMP%]{font-size:1rem}}@media (max-width: 768px){.benefits-title[_ngcontent-%COMP%]{font-size:.875rem}}.benefits-list[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:1rem;align-items:center}.benefits-text-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2rem;margin-left:12px}@media (max-width: 1200px){.benefits-text-list[_ngcontent-%COMP%]{gap:1.5rem;margin-left:8px}}@media (max-width: 768px){.benefits-text-list[_ngcontent-%COMP%]{gap:1rem;margin-left:4px}}.benefit-item[_ngcontent-%COMP%]{font-size:1rem;color:#a0a0a0;font-weight:300;line-height:14px}@media (max-width: 1200px){.benefit-item[_ngcontent-%COMP%]{font-size:.875rem}}@media (max-width: 768px){.benefit-item[_ngcontent-%COMP%]{font-size:.75rem;line-height:12px}}.plans-container[_ngcontent-%COMP%]{display:flex;flex:1;gap:1.5rem;align-items:end}@media (max-width: 1200px){.plans-container[_ngcontent-%COMP%]{gap:1rem;min-width:600px}}@media (max-width: 768px){.plans-container[_ngcontent-%COMP%]{gap:.75rem;min-width:500px}}.plan-card[_ngcontent-%COMP%]{flex:1;padding:1rem;border:.5px solid #4a4a4a;border-radius:.5rem;position:relative;display:flex;flex-direction:column;gap:1.5rem;height:fit-content;min-width:200px}.plan-card[_ngcontent-%COMP%]:last-child{border-right:none}.plan-card.current-plan[_ngcontent-%COMP%]{background:#5186e40d}@media (max-width: 1200px){.plan-card[_ngcontent-%COMP%]{padding:.875rem;gap:1.25rem;min-width:180px}}@media (max-width: 768px){.plan-card[_ngcontent-%COMP%]{padding:.75rem;gap:1rem;min-width:160px}}.current-plan-badge[_ngcontent-%COMP%]{background:#9bf526;color:#222325;padding:.4rem .75rem;border-radius:.375rem;font-size:.75rem;font-weight:600;width:fit-content}@media (max-width: 1200px){.current-plan-badge[_ngcontent-%COMP%]{padding:.35rem .65rem;font-size:.7rem}}@media (max-width: 768px){.current-plan-badge[_ngcontent-%COMP%]{padding:.3rem .55rem;font-size:.65rem}}.plan-header[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}@media (max-width: 1200px){.plan-header[_ngcontent-%COMP%]{gap:.4rem}}@media (max-width: 768px){.plan-header[_ngcontent-%COMP%]{gap:.3rem}}.plan-name[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:600;color:#fff;margin:0}@media (max-width: 1200px){.plan-name[_ngcontent-%COMP%]{font-size:1.125rem}}@media (max-width: 768px){.plan-name[_ngcontent-%COMP%]{font-size:1rem}}.plan-price[_ngcontent-%COMP%]{display:flex;align-items:baseline;gap:.25rem}@media (max-width: 1200px){.plan-price[_ngcontent-%COMP%]{gap:.2rem}}@media (max-width: 768px){.plan-price[_ngcontent-%COMP%]{gap:.15rem}}.price[_ngcontent-%COMP%]{font-size:2rem;font-weight:700;color:#fff}@media (max-width: 1200px){.price[_ngcontent-%COMP%]{font-size:1.75rem}}@media (max-width: 768px){.price[_ngcontent-%COMP%]{font-size:1.5rem}}.period[_ngcontent-%COMP%]{font-size:.875rem;color:#a0a0a0}@media (max-width: 1200px){.period[_ngcontent-%COMP%]{font-size:.8rem}}@media (max-width: 768px){.period[_ngcontent-%COMP%]{font-size:.75rem}}.plan-features[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.3rem}@media (max-width: 1200px){.plan-features[_ngcontent-%COMP%]{gap:1.1rem}}@media (max-width: 768px){.plan-features[_ngcontent-%COMP%]{gap:.9rem}}.feature-row[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;min-height:1.5rem}@media (max-width: 1200px){.feature-row[_ngcontent-%COMP%]{min-height:1.3rem}}@media (max-width: 768px){.feature-row[_ngcontent-%COMP%]{min-height:1.1rem}}.feature-value[_ngcontent-%COMP%]{font-size:1rem;font-weight:600;color:#fff}@media (max-width: 1200px){.feature-value[_ngcontent-%COMP%]{font-size:.9rem}}@media (max-width: 768px){.feature-value[_ngcontent-%COMP%]{font-size:.8rem}}.feature-check[_ngcontent-%COMP%]{color:#9bf526;font-size:1.125rem;font-weight:700}@media (max-width: 1200px){.feature-check[_ngcontent-%COMP%]{font-size:1rem}}@media (max-width: 768px){.feature-check[_ngcontent-%COMP%]{font-size:.9rem}}.plan-footer[_ngcontent-%COMP%]{margin-top:auto}.plan-button[_ngcontent-%COMP%]{width:100%;padding:.75rem 1rem;border-radius:.375rem;font-size:.875rem;font-weight:600;cursor:pointer;transition:all .2s ease;border:1px solid #4a4a4a;background:transparent;color:#fff}.plan-button[_ngcontent-%COMP%]:hover{background:#2a2a2b}.plan-button.current-plan-button[_ngcontent-%COMP%]{background:#9bf526;color:#222325;border-color:#9bf526}.plan-button.current-plan-button[_ngcontent-%COMP%]:hover{background:#8ae51f}@media (max-width: 1200px){.plan-button[_ngcontent-%COMP%]{padding:.65rem .875rem;font-size:.8rem}}@media (max-width: 768px){.plan-button[_ngcontent-%COMP%]{padding:.55rem .75rem;font-size:.75rem}}@media (max-width: 1024px){.membership-info[_ngcontent-%COMP%]{flex-direction:column;gap:1.5rem}.info-column[_ngcontent-%COMP%]{gap:1rem}.comparison-table[_ngcontent-%COMP%]{overflow-x:auto;gap:1rem}.benefits-column[_ngcontent-%COMP%]{flex:0 0 180px;border-right:1px solid #4a4a4a}.plans-container[_ngcontent-%COMP%]{flex-direction:row;min-width:600px}.plan-card[_ngcontent-%COMP%]{border-right:1px solid #4a4a4a;border-bottom:none}.plan-card[_ngcontent-%COMP%]:last-child{border-right:none}}@media (max-width: 768px){.membership-card[_ngcontent-%COMP%]{padding:1.5rem}.membership-info[_ngcontent-%COMP%]{gap:1rem}.info-column[_ngcontent-%COMP%]{gap:.75rem}.benefits-list[_ngcontent-%COMP%]{grid-template-columns:1fr}.comparison-table[_ngcontent-%COMP%]{overflow-x:auto;gap:.75rem}.benefits-column[_ngcontent-%COMP%]{flex:0 0 160px;padding:3rem .75rem 1.5rem}.plans-container[_ngcontent-%COMP%]{min-width:500px;gap:.75rem}.plan-card[_ngcontent-%COMP%]{padding:.75rem;min-width:160px}}']})};Te();Ae();Ne();var Y=class s{constructor(t){this.platformId=t;this.isBrowser=ie(this.platformId),this.isBrowser&&(this.db=pe(ue))}isBrowser;db=null;deleteUserData(t){return g(this,null,function*(){if(!this.db)return console.warn("Firestore not available in SSR"),!1;try{let e=me(this.db),n=0,a=yield this.deleteUserAccounts(t,e);n+=a;let m=yield this.deleteUserConfigurations(t,e);n+=m;let d=yield this.deleteUserMonthlyReports(t,e);n+=d;let P=yield this.deleteUserPluginHistory(t,e);n+=P;let F=yield this.deleteUserTokens(t,e);n+=F;let I=yield this.deleteUserSubscriptions(t,e);n+=I;let Ie=yield this.deleteUser(t,e);return n+=Ie,n>0?(yield e.commit(),!0):(console.log(`\u26A0\uFE0F No data found to delete for user ${t}`),!0)}catch(e){return console.error("\u274C Error deleting user data:",e),!1}})}deleteUserAccounts(t,e){return g(this,null,function*(){try{let n=D(this.db,"accounts"),a=U(n,z("userId","==",t)),m=yield k(a),d=0;return m.forEach(P=>{e.delete(P.ref),d++}),console.log(`\u{1F4CA} Deleting ${d} accounts for user ${t}`),d}catch(n){return console.error("Error deleting accounts:",n),0}})}deleteUserConfigurations(t,e){return g(this,null,function*(){try{let n=D(this.db,"configuration-overview"),a=U(n,z("userId","==",t)),m=yield k(a),d=0,P=[];m.forEach(F=>{let I=F.data();I.configurationId&&P.push(I.configurationId),e.delete(F.ref),d++});for(let F of P){let I=J(this.db,"configurations",F);e.delete(I),d++}return console.log(`\u2699\uFE0F Deleting ${d} configurations for user ${t}`),d}catch(n){return console.error("Error deleting configurations:",n),0}})}deleteUserMonthlyReports(t,e){return g(this,null,function*(){try{let n=D(this.db,"monthly_reports"),a=U(n,z("id","==",t)),m=yield k(a),d=0;return m.forEach(P=>{e.delete(P.ref),d++}),console.log(`\u{1F4C8} Deleting ${d} monthly reports for user ${t}`),d}catch(n){return console.error("Error deleting monthly reports:",n),0}})}deleteUserPluginHistory(t,e){return g(this,null,function*(){try{let n=D(this.db,"plugin_history"),a=U(n,z("id","==",t)),m=yield k(a),d=0;return m.forEach(P=>{e.delete(P.ref),d++}),console.log(`\u{1F50C} Deleting ${d} plugin histories for user ${t}`),d}catch(n){return console.error("Error deleting plugin history:",n),0}})}deleteUserTokens(t,e){return g(this,null,function*(){try{let n=D(this.db,"tokens"),a=U(n,z("userId","==",t)),m=yield k(a),d=0;return m.forEach(P=>{e.delete(P.ref),d++}),console.log(`\u{1F511} Deleting ${d} tokens for user ${t}`),d}catch(n){return console.error("Error deleting tokens:",n),0}})}deleteUserSubscriptions(t,e){return g(this,null,function*(){try{let n=D(this.db,"users",t,"subscription"),a=yield k(n),m=0;return a.forEach(d=>{e.delete(d.ref),m++}),console.log(`\u{1F4B3} Deleting ${m} subscriptions for user ${t}`),m}catch(n){return console.error("Error deleting subscriptions:",n),0}})}deleteUser(t,e){return g(this,null,function*(){try{let n=J(this.db,"users",t);return e.delete(n),console.log(`\u{1F464} Deleting user ${t} from users collection`),1}catch(n){return console.error("Error deleting user:",n),0}})}static \u0275fac=function(e){return new(e||s)(X(ne))};static \u0275prov=Q({token:s,factory:s.\u0275fac,providedIn:"root"})};function Be(s,t){if(s&1&&(r(0,"div",34),o(1),i()),s&2){let e=c();l(),u(" ",e.getFieldError("firstName")," ")}}function Ge(s,t){if(s&1&&(r(0,"div",34),o(1),i()),s&2){let e=c();l(),u(" ",e.getFieldError("lastName")," ")}}function Ye(s,t){if(s&1&&(r(0,"div",34),o(1),i()),s&2){let e=c();l(),u(" ",e.getFieldError("birthday")," ")}}function He(s,t){s&1&&f(0,"span",35)}function Je(s,t){if(s&1&&(r(0,"div",34),o(1),i()),s&2){let e=c(2);l(),u(" ",e.getPasswordFieldError("currentPassword")," ")}}function Ke(s,t){if(s&1&&(r(0,"div",34),o(1),i()),s&2){let e=c(2);l(),u(" ",e.getPasswordFieldError("confirmPassword")," ")}}function We(s,t){s&1&&f(0,"span",35)}function Ze(s,t){if(s&1&&(r(0,"div",44),o(1),i()),s&2){let e=c(2);l(),u(" ",e.passwordChangeMessage," ")}}function Qe(s,t){if(s&1&&(r(0,"div",45),o(1),i()),s&2){let e=c(2);l(),u(" ",e.passwordChangeError," ")}}function Xe(s,t){if(s&1){let e=v();r(0,"form",36),h("ngSubmit",function(){_(e);let a=c();return b(a.onChangePassword())}),r(1,"div",9)(2,"label",37),o(3,"Current Password"),i(),f(4,"input",38),C(5,Je,2,1,"div",12),i(),r(6,"div",9),f(7,"app-password-input",39),i(),r(8,"div",9)(9,"label",40),o(10,"Confirm New Password"),i(),f(11,"input",41),C(12,Ke,2,1,"div",12),i(),r(13,"div",20)(14,"button",21),C(15,We,1,0,"span",22),o(16),i()(),C(17,Ze,2,1,"div",42)(18,Qe,2,1,"div",43),i()}if(s&2){let e,n,a=c();p("formGroup",a.passwordForm),l(4),x("error",((e=a.passwordForm.get("currentPassword"))==null?null:e.errors)&&((e=a.passwordForm.get("currentPassword"))==null?null:e.touched)),l(),p("ngIf",a.getPasswordFieldError("currentPassword")),l(2),p("showValidation",!0)("userEmail",(a.user==null?null:a.user.email)||"")("userName",(a.user==null?null:a.user.firstName)||""),l(4),x("error",((n=a.passwordForm.get("confirmPassword"))==null?null:n.errors)&&((n=a.passwordForm.get("confirmPassword"))==null?null:n.touched)),l(),p("ngIf",a.getPasswordFieldError("confirmPassword")),l(2),p("disabled",a.passwordForm.invalid||a.isLoading),l(),p("ngIf",a.isLoading),l(),u(" ",a.isLoading?"Updating...":"Update Password"," "),l(),p("ngIf",a.passwordChangeMessage),l(),p("ngIf",a.passwordChangeError)}}function et(s,t){s&1&&f(0,"span",35)}function tt(s,t){if(s&1&&(r(0,"div",34),o(1),i()),s&2){let e=c(2);l(),u(" ",e.deleteAccountError," ")}}function nt(s,t){if(s&1){let e=v();r(0,"div",46)(1,"div",47)(2,"h2",6),o(3,"Delete Account"),i(),r(4,"p",31),o(5," Are you sure you want to delete your account? This action will: "),i(),r(6,"ul",48)(7,"li"),o(8,"Permanently delete all your data"),i(),r(9,"li"),o(10,"Remove all your trading accounts"),i(),r(11,"li"),o(12,"Delete all your strategies and configurations"),i(),r(13,"li"),o(14,"Remove your report history"),i(),r(15,"li"),o(16,"Delete all your subscriptions and payments"),i(),r(17,"li"),o(18,"This action CANNOT be undone"),i()(),r(19,"div",49)(20,"button",32),h("click",function(){_(e);let a=c();return b(a.confirmDeleteAccount())}),C(21,et,1,0,"span",22),o(22),i(),r(23,"button",50),h("click",function(){_(e);let a=c();return b(a.cancelDeleteAccount())}),o(24," Cancel "),i()(),C(25,tt,2,1,"div",12),i()()}if(s&2){let e=c();l(20),p("disabled",e.isDeletingAccount),l(),p("ngIf",e.isDeletingAccount),l(),u(" ",e.isDeletingAccount?"Deleting...":"Yes, Delete Account"," "),l(),p("disabled",e.isDeletingAccount),l(2),p("ngIf",e.deleteAccountError)}}var H=class s{constructor(t){this.store=t;this.profileForm=this.fb.group({firstName:["",[M.required,M.minLength(2)]],lastName:["",[M.required,M.minLength(2)]],email:["",[M.required,M.email]],birthday:["",[M.required]]}),this.passwordForm=this.fb.group({currentPassword:["",[M.required]],newPassword:["",[M.required]],confirmPassword:["",[M.required]]},{validators:this.passwordMatchValidator})}user=null;profileForm;passwordForm;isLoading=!1;showPasswordForm=!1;passwordChangeMessage="";passwordChangeError="";showDeleteModal=!1;isDeletingAccount=!1;deleteAccountError="";authService=y(q);fb=y(Ce);accountDeletionService=y(Y);router=y(oe);appContext=y(j);ngOnInit(){this.subscribeToContextData()}subscribeToContextData(){this.appContext.currentUser$.subscribe({next:t=>{this.user=t,this.user&&this.populateForm()},error:t=>{console.error("Error fetching user data from context",t)}})}populateForm(){this.user&&this.profileForm.patchValue({firstName:this.user.firstName||"",lastName:this.user.lastName||"",email:this.user.email||"",birthday:this.user.birthday||""})}passwordMatchValidator(t){let e=t.get("newPassword"),n=t.get("confirmPassword");return e&&n&&e.value!==n.value?(n.setErrors({passwordMismatch:!0}),{passwordMismatch:!0}):null}onUpdateProfile(){return g(this,null,function*(){if(this.profileForm.valid&&this.user){this.isLoading=!0;try{yield this.authService.updateUser(this.user.id,{firstName:this.profileForm.value.firstName,lastName:this.profileForm.value.lastName,birthday:this.profileForm.value.birthday}),this.store.dispatch({type:"[User] Update User",user:Z(W({},this.user),{firstName:this.profileForm.value.firstName,lastName:this.profileForm.value.lastName,birthday:this.profileForm.value.birthday})}),console.log("\u2705 Profile updated successfully")}catch(t){console.error("\u274C Error updating profile:",t)}finally{this.isLoading=!1}}})}onChangePassword(){return g(this,null,function*(){if(this.passwordForm.valid&&this.user){this.isLoading=!0,this.passwordChangeMessage="",this.passwordChangeError="";try{let t=this.authService.getCurrentUser();if(!t)throw new Error("User not authenticated");let e=this.passwordForm.value.currentPassword,n=this.passwordForm.value.newPassword,a=se.credential(this.user.email,e);yield le(t,a),yield ce(t,n),this.passwordChangeMessage="Password updated successfully",this.passwordForm.reset(),this.showPasswordForm=!1}catch(t){console.error("\u274C Error changing password:",t),t.code==="auth/wrong-password"?this.passwordChangeError="Current password is incorrect":t.code==="auth/weak-password"?this.passwordChangeError="New password is too weak":t.code==="auth/requires-recent-login"?this.passwordChangeError="For security, please sign in again":this.passwordChangeError="Error changing password. Please try again"}finally{this.isLoading=!1}}})}togglePasswordForm(){this.showPasswordForm=!this.showPasswordForm,this.passwordChangeMessage="",this.passwordChangeError="",this.passwordForm.reset()}getFieldError(t){let e=this.profileForm.get(t);if(e?.errors&&e.touched){if(e.errors.required)return`${t} is required`;if(e.errors.email)return"Invalid email";if(e.errors.minlength)return`${t} must have at least ${e.errors.minlength.requiredLength} characters`}return""}getPasswordFieldError(t){let e=this.passwordForm.get(t);if(e?.errors&&e.touched){if(e.errors.required)return`${t} is required`;if(e.errors.minlength)return"Password must have at least 6 characters";if(e.errors.passwordMismatch)return"Passwords do not match"}return""}showDeleteAccountModal(){this.showDeleteModal=!0,this.deleteAccountError=""}cancelDeleteAccount(){this.showDeleteModal=!1,this.deleteAccountError=""}confirmDeleteAccount(){return g(this,null,function*(){if(!this.user){this.deleteAccountError="User not found";return}this.isDeletingAccount=!0,this.deleteAccountError="";try{if(!(yield this.accountDeletionService.deleteUserData(this.user.id)))throw new Error("Error deleting Firebase data");let e=this.authService.getCurrentUser();e&&(yield de(e)),this.store.dispatch({type:"[User] Clear User"}),this.router.navigate(["/login"])}catch(t){console.error("\u274C Error deleting account:",t),t.code==="auth/requires-recent-login"?this.deleteAccountError="For security, you need to sign in again before deleting your account":t.code==="auth/too-many-requests"?this.deleteAccountError="Too many attempts. Please try again later":this.deleteAccountError="Error deleting account. Please try again"}finally{this.isDeletingAccount=!1}})}static \u0275fac=function(e){return new(e||s)(w(N))};static \u0275cmp=T({type:s,selectors:[["app-profile-details"]],decls:56,vars:21,consts:[[1,"profile-details-section"],[1,"main-titles","color-background","d-flex","flex-col","mb-24"],[1,"subtitle","mb-8"],[1,"regularText"],[1,"profile-form-section"],[1,"form-card"],[1,"form-title"],[3,"ngSubmit","formGroup"],[1,"form-grid"],[1,"form-group"],["for","firstName",1,"form-label"],["type","text","id","firstName","formControlName","firstName","placeholder","Enter your first name",1,"form-input"],["class","error-message",4,"ngIf"],["for","lastName",1,"form-label"],["type","text","id","lastName","formControlName","lastName","placeholder","Enter your last name",1,"form-input"],["for","email",1,"form-label"],["type","email","id","email","formControlName","email","placeholder","Enter your email address","readonly","",1,"form-input"],[1,"form-note"],["for","birthday",1,"form-label"],["type","date","id","birthday","formControlName","birthday",1,"form-input"],[1,"form-actions"],["type","submit",1,"btn-primary",3,"disabled"],["class","loading-spinner",4,"ngIf"],[1,"password-section"],[1,"password-card"],[1,"password-header"],[1,"password-description"],["type","button",1,"btn-secondary",3,"click","disabled"],["class","password-form",3,"formGroup","ngSubmit",4,"ngIf"],[1,"delete-account-section"],[1,"delete-account-card"],[1,"delete-account-description"],[1,"delete-account-btn",3,"click","disabled"],["class","delete-account-modal",4,"ngIf"],[1,"error-message"],[1,"loading-spinner"],[1,"password-form",3,"ngSubmit","formGroup"],["for","currentPassword",1,"form-label"],["type","password","id","currentPassword","formControlName","currentPassword","placeholder","Enter your current password",1,"form-input"],["label","New Password","placeholder","Enter your new password","formControlName","newPassword",1,"form-input",3,"showValidation","userEmail","userName"],["for","confirmPassword",1,"form-label"],["type","password","id","confirmPassword","formControlName","confirmPassword","placeholder","Confirm your new password",1,"form-input"],["class","message success",4,"ngIf"],["class","message error",4,"ngIf"],[1,"message","success"],[1,"message","error"],[1,"delete-account-modal"],[1,"modal-content"],[1,"deletion-warning-list"],[1,"modal-actions"],[1,"cancel-account-btn",3,"click","disabled"]],template:function(e,n){if(e&1&&(r(0,"div",0)(1,"div",1)(2,"h1",2),o(3,"Profile Details"),i(),r(4,"h3",3),o(5," Manage your personal information and account settings. "),i()(),r(6,"div",4)(7,"div",5)(8,"h2",6),o(9,"Personal Information"),i(),r(10,"form",7),h("ngSubmit",function(){return n.onUpdateProfile()}),r(11,"div",8)(12,"div",9)(13,"label",10),o(14,"First Name"),i(),f(15,"input",11),C(16,Be,2,1,"div",12),i(),r(17,"div",9)(18,"label",13),o(19,"Last Name"),i(),f(20,"input",14),C(21,Ge,2,1,"div",12),i(),r(22,"div",9)(23,"label",15),o(24,"Email Address"),i(),f(25,"input",16),r(26,"div",17),o(27,"Email cannot be changed"),i()(),r(28,"div",9)(29,"label",18),o(30,"Birthday"),i(),f(31,"input",19),C(32,Ye,2,1,"div",12),i()(),r(33,"div",20)(34,"button",21),C(35,He,1,0,"span",22),o(36),i()()()()(),r(37,"div",23)(38,"div",24)(39,"div",25)(40,"h2",6),o(41,"Change Password"),i(),r(42,"p",26),o(43," Update your password to keep your account secure. "),i()(),r(44,"button",27),h("click",function(){return n.togglePasswordForm()}),o(45),i(),C(46,Xe,19,15,"form",28),i()(),r(47,"div",29)(48,"div",30)(49,"h2",6),o(50,"Delete Account"),i(),r(51,"p",31),o(52," Delete your account to permanently remove your data. "),i()(),r(53,"button",32),h("click",function(){return n.showDeleteAccountModal()}),o(54),i()(),C(55,nt,26,5,"div",33),i()),e&2){let a,m,d,P;l(10),p("formGroup",n.profileForm),l(5),x("error",((a=n.profileForm.get("firstName"))==null?null:a.errors)&&((a=n.profileForm.get("firstName"))==null?null:a.touched)),l(),p("ngIf",n.getFieldError("firstName")),l(4),x("error",((m=n.profileForm.get("lastName"))==null?null:m.errors)&&((m=n.profileForm.get("lastName"))==null?null:m.touched)),l(),p("ngIf",n.getFieldError("lastName")),l(4),x("error",((d=n.profileForm.get("email"))==null?null:d.errors)&&((d=n.profileForm.get("email"))==null?null:d.touched)),l(6),x("error",((P=n.profileForm.get("birthday"))==null?null:P.errors)&&((P=n.profileForm.get("birthday"))==null?null:P.touched)),l(),p("ngIf",n.getFieldError("birthday")),l(2),p("disabled",n.profileForm.invalid||n.isLoading),l(),p("ngIf",n.isLoading),l(),u(" ",n.isLoading?"Updating...":"Update Profile"," "),l(8),p("disabled",n.isLoading),l(),u(" ",n.showPasswordForm?"Cancel":"Change Password"," "),l(),p("ngIf",n.showPasswordForm),l(7),p("disabled",n.isDeletingAccount),l(),u(" ",n.isDeletingAccount?"Deleting...":"Delete Account"," "),l(),p("ngIf",n.showDeleteModal)}},dependencies:[A,re,xe,Pe,ge,fe,he,_e,be,we],styles:[".profile-details-section[_ngcontent-%COMP%]{font-family:SF Pro Display;padding-right:1.5rem}@media (max-width: 1024px){.profile-details-section[_ngcontent-%COMP%]{padding-right:0}}.main-titles[_ngcontent-%COMP%]{margin-bottom:2rem}.form-card[_ngcontent-%COMP%], .password-card[_ngcontent-%COMP%]{margin-bottom:2rem;width:100%}@media (max-width: 1024px){.form-card[_ngcontent-%COMP%], .password-card[_ngcontent-%COMP%]{padding:0!important}}.form-title[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:600;color:#fff;margin:0 0 1rem}.form-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:1.5rem;margin-bottom:1rem}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.form-label[_ngcontent-%COMP%]{font-size:.875rem;font-weight:500;color:#a0a0a0}.form-input[_ngcontent-%COMP%]{padding:.75rem 1rem;border:1px solid #4a4a4a;border-radius:.5rem;background:#1a1a1b;color:#fff;font-size:.875rem;transition:all .2s ease}.form-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#9bf526;box-shadow:0 0 0 2px #9bf5261a}.form-input.error[_ngcontent-%COMP%]{border-color:#ff3b30}.form-input[readonly][_ngcontent-%COMP%]{background:#2a2a2b;color:#a0a0a0;cursor:not-allowed}.form-note[_ngcontent-%COMP%]{font-size:.75rem;color:#a0a0a0;font-style:italic}.error-message[_ngcontent-%COMP%]{font-size:.75rem;color:#ff3b30;margin-top:.25rem}.form-actions[_ngcontent-%COMP%]{display:flex;gap:1rem;justify-content:flex-end}.btn-primary[_ngcontent-%COMP%]{background:#9bf526;color:#222325;border:none;padding:.75rem 1.5rem;border-radius:.5rem;font-size:.875rem;font-weight:600;cursor:pointer;transition:all .2s ease;display:flex;align-items:center;gap:.5rem}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){background:#8ae51f}.btn-primary[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.btn-secondary[_ngcontent-%COMP%]{background:transparent;color:#fff;border:1px solid #4a4a4a;padding:.75rem 1.5rem;border-radius:.5rem;font-size:.875rem;font-weight:600;cursor:pointer;transition:all .2s ease}.btn-secondary[_ngcontent-%COMP%]:hover:not(:disabled){background:#2a2a2b;border-color:#6a6a6a}.btn-secondary[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.loading-spinner[_ngcontent-%COMP%]{width:16px;height:16px;border:2px solid transparent;border-top:2px solid currentColor;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.password-section[_ngcontent-%COMP%]{margin-top:2rem}.password-header[_ngcontent-%COMP%]{margin-bottom:1.5rem}.password-description[_ngcontent-%COMP%]{font-size:.875rem;color:#a0a0a0;margin:.5rem 0 0}.password-form[_ngcontent-%COMP%]{margin-top:1.5rem;padding-top:1.5rem;border-top:1px solid #4a4a4a}.message[_ngcontent-%COMP%]{padding:.75rem 1rem;border-radius:.5rem;font-size:.875rem;font-weight:500;margin-top:1rem}.message.success[_ngcontent-%COMP%]{background:#14ae5c26;color:#14ae5c;border:1px solid rgba(20,174,92,.3)}.message.error[_ngcontent-%COMP%]{background:#ff3b3026;color:#ff3b30;border:1px solid rgba(255,59,48,.3)}@media (max-width: 1024px){.form-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:1rem}.form-actions[_ngcontent-%COMP%]{justify-content:stretch}.btn-primary[_ngcontent-%COMP%], .btn-secondary[_ngcontent-%COMP%]{flex:1}}@media (max-width: 768px){.profile-details-section[_ngcontent-%COMP%]{padding-right:0}.form-card[_ngcontent-%COMP%], .password-card[_ngcontent-%COMP%]{padding:1.5rem}.form-grid[_ngcontent-%COMP%]{gap:.75rem}.form-actions[_ngcontent-%COMP%]{flex-direction:column}}.delete-account-section[_ngcontent-%COMP%]{padding-top:1rem}.delete-account-card[_ngcontent-%COMP%]{margin-bottom:1rem}.delete-account-description[_ngcontent-%COMP%]{font-size:.875rem;color:#a0a0a0;line-height:1.5}.delete-account-btn[_ngcontent-%COMP%]{background:#ff3b30;color:#fff;border:none;padding:.75rem 1.5rem;border-radius:.5rem;font-size:.875rem;font-weight:600;cursor:pointer;transition:all .2s ease;display:flex;align-items:center;gap:.5rem}.delete-account-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:#e5342a}.delete-account-btn[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.delete-account-modal[_ngcontent-%COMP%]{position:fixed;inset:0;background:#000c;display:flex;align-items:center;justify-content:center;z-index:1000;padding:1rem}.modal-content[_ngcontent-%COMP%]{background:#1a1a1b;border:1px solid #4a4a4a;border-radius:1rem;padding:2rem;max-width:500px;width:100%;max-height:90vh;overflow-y:auto}.deletion-warning-list[_ngcontent-%COMP%]{margin:1rem 0;padding-left:1.5rem}.deletion-warning-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{color:#ff3b30;font-size:.875rem;margin-bottom:.5rem;line-height:1.4}.modal-actions[_ngcontent-%COMP%]{display:flex;gap:1rem;margin-top:2rem;justify-content:flex-end}.cancel-account-btn[_ngcontent-%COMP%]{background:transparent;color:#a0a0a0;border:1px solid #4a4a4a;padding:.75rem 1.5rem;border-radius:.5rem;font-size:.875rem;font-weight:600;cursor:pointer;transition:all .2s ease}.cancel-account-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:#2a2a2b;border-color:#6a6a6a;color:#fff}.cancel-account-btn[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}@media (max-width: 768px){.modal-content[_ngcontent-%COMP%]{padding:1.5rem;margin:1rem}.modal-actions[_ngcontent-%COMP%]{flex-direction:column}.modal-actions[_ngcontent-%COMP%]   .delete-account-btn[_ngcontent-%COMP%], .modal-actions[_ngcontent-%COMP%]   .cancel-account-btn[_ngcontent-%COMP%]{flex:1}}"]})};function rt(s,t){if(s&1){let e=v();r(0,"button",6),h("click",function(){let a=_(e).$index,m=c();return b(m.selectTypeData(a))}),o(1),i()}if(s&2){let e=t.$implicit,n=t.$index,a=c();x("active",a.selectedIndex===n),l(),u(" ",e.label," ")}}function it(s,t){s&1&&f(0,"app-profile-details")}function ot(s,t){if(s&1&&f(0,"app-plan-settings",5),s&2){let e=c();p("planDetails",e.selectedPlanDetails)}}var Fe=class s{constructor(t,e,n,a){this.store=t;this.strategySvc=e;this.reportSvc=n;this.appContext=a}user=null;selectedIndex=0;tabs=[{label:"Profile Details"},{label:"Plan Management"}];selectedPlanDetails=null;ngOnInit(){this.selectedPlanDetails=Se,this.appContext.currentUser$.subscribe(t=>{this.user=t}),this.user||(this.appContext.setLoading("user",!0),this.appContext.setLoading("user",!1))}selectTypeData(t){this.selectedIndex=t}static \u0275fac=function(e){return new(e||s)(w(N),w($),w(B),w(j))};static \u0275cmp=T({type:s,selectors:[["app-account"]],decls:10,vars:2,consts:[[1,"main-titles","color-background","d-flex","flex-col","mb-24"],[1,"titleText","mb-16"],[1,"regularText"],[1,"btn-group","d-flex","align-center","mb-24"],[1,"p-10","regularText",3,"active"],[3,"planDetails"],[1,"p-10","regularText",3,"click"]],template:function(e,n){e&1&&(r(0,"div",0)(1,"h1",1),o(2,"My Account"),i(),r(3,"h3",2),o(4," Review your plan, billing cycle, and update your subscription preferences. "),i()(),r(5,"div",3),L(6,rt,2,3,"button",4,V),i(),O(8,it,1,0,"app-profile-details"),O(9,ot,1,1,"app-plan-settings",5)),e&2&&(l(6),R(n.tabs),l(2),S(n.selectedIndex===0?8:-1),l(),S(n.selectedIndex===1?9:-1))},dependencies:[A,G,H],styles:[".btn-group[_ngcontent-%COMP%]{gap:8px;margin:0 auto;width:fit-content}.btn-group[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:transparent;color:#dfdfdf;border:1px solid #eaf2f8;border-radius:1.5rem;cursor:pointer;transition:background .2s}.btn-group[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background:#d5ff91;color:#111}.btn-group[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background-color:#d5ff91;color:#111;border:none}"]})};export{Fe as AccountComponent};

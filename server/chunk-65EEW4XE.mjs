import './polyfills.server.mjs';
import{a as xe}from"./chunk-ZSPWQS5N.mjs";import{a as Me}from"./chunk-NRJUXJQG.mjs";import{a as Ce}from"./chunk-6KAGFALR.mjs";import{f as he,i as be}from"./chunk-6SLXWV7I.mjs";import{a as fe}from"./chunk-ORX2TWOL.mjs";import{a as se}from"./chunk-ZQTEKPLK.mjs";import"./chunk-4QIT3UAD.mjs";import"./chunk-PUENJBJ5.mjs";import"./chunk-DPLNUI4A.mjs";import{c as S,f as E,i as D,k as z,o as pe,p as me,q as ge,r as _e,s as j,v as k}from"./chunk-ZUEZAN7G.mjs";import{q as N}from"./chunk-5EV7JWWV.mjs";import{a as W}from"./chunk-SS4N7RKX.mjs";import{a as F,q as de,v as ue}from"./chunk-YWJXSM6M.mjs";import{Ab as C,C as I,Cb as u,Eb as d,Ka as l,Pa as x,Pb as V,Qb as te,Rb as r,Sb as M,Tb as v,Ub as ne,Va as O,Wb as _,Xb as f,Yb as h,Yc as ae,_a as X,ab as P,cd as re,ea as p,ec as R,ed as ce,fa as m,gc as oe,gd as A,hc as ie,lb as y,m as Q,mb as w,nb as Z,ob as $,pb as ee,qb as g,rb as n,sa as L,sb as a,tb as B,zd as le}from"./chunk-YCCZPWYV.mjs";import"./chunk-RF6MMMYN.mjs";import{a as H,b as J,k as b}from"./chunk-H4UZCO6D.mjs";de();var U=class s{account=null;confirm=new P;cancel=new P;accountNameInput="";get accountName(){return this.account?.accountName??""}onConfirm(){this.accountNameInput.trim()===this.accountName&&this.confirm.emit()}onCancel(){this.cancel.emit()}static \u0275fac=function(e){return new(e||s)};static \u0275cmp=O({type:s,selectors:[["app-show-confirmation"]],inputs:{account:"account"},outputs:{confirm:"confirm",cancel:"cancel"},decls:12,vars:3,consts:[[1,"modal-backdrop"],[1,"modal-content","p-32","d-flex","flex-col"],[1,"subtitle","mb-24"],[1,"regularText","mb-24"],["type","text","placeholder","Account Name",1,"input","regularSemiText","mb-24",3,"ngModelChange","ngModel","autofocus"],[1,"buttons","d-flex","justify-between"],[1,"secondary","p-10",3,"click"],[1,"primary","p-10",3,"click","disabled"]],template:function(e,i){e&1&&(n(0,"div",0)(1,"div",1)(2,"h2",2),r(3,"Delete this trading account?"),a(),n(4,"p",3),r(5," This action will permanently remove the selected trading account. To confirm, please type the account name below. Once deleted, this action cannot be undone. "),a(),n(6,"input",4),h("ngModelChange",function(c){return f(i.accountNameInput,c)||(i.accountNameInput=c),c}),a(),n(7,"div",5)(8,"button",6),u("click",function(){return i.onCancel()}),r(9,"Cancel"),a(),n(10,"button",7),u("click",function(){return i.onConfirm()}),r(11," Delete account "),a()()()()),e&2&&(l(6),_("ngModel",i.accountNameInput),g("autofocus",!0),l(4),g("disabled",i.accountNameInput.trim()!==i.accountName))},dependencies:[A,k,S,E,D],styles:[".modal-backdrop[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100vw;height:100vh;background:#282828bf;display:flex;align-items:center;justify-content:center;z-index:1000}.modal-content[_ngcontent-%COMP%]{background:#232325;color:#fff;border-radius:16px;max-width:22.9375rem;box-shadow:0 8px 24px #00000040;gap:1rem}.modal-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#c5dbf8;line-height:normal}.input[_ngcontent-%COMP%]{background:transparent;border:1px solid var(--Grays-Gray, #8e8e93);border-radius:.375rem;padding:.75rem;color:#fff}.input[_ngcontent-%COMP%]:focus{outline:2px solid #444}.buttons[_ngcontent-%COMP%]{gap:1rem}button[_ngcontent-%COMP%]{width:50%;border-radius:8px;border:none;font-size:1rem;cursor:pointer;font-weight:500}.secondary[_ngcontent-%COMP%]{background:transparent;color:#fff;border:1px solid #444;transition:background .2s}.secondary[_ngcontent-%COMP%]:hover{background:#333}.primary[_ngcontent-%COMP%]{background:#992828;color:#fff;transition:background .2s}.primary[_ngcontent-%COMP%]:disabled{background:#2e2e33;color:#999;cursor:not-allowed}.primary[_ngcontent-%COMP%]:not(:disabled):hover{background:#d32e2e}"]})};function Oe(s,o){if(s&1){let e=C();n(0,"div",15)(1,"label",37),r(2,"Balance:"),a(),n(3,"div",38)(4,"input",39),h("ngModelChange",function(t){p(e);let c=d();return f(c.initialMinBalance,t)||(c.initialMinBalance=t),m(t)}),a(),n(5,"label",40),r(6,"min $"),a()(),n(7,"div",38)(8,"input",41),h("ngModelChange",function(t){p(e);let c=d();return f(c.initialMaxBalance,t)||(c.initialMaxBalance=t),m(t)}),a(),n(9,"label",42),r(10,"max $"),a()(),n(11,"button",43),u("click",function(){p(e);let t=d();return m(t.apply())}),r(12," Apply "),a()()}if(s&2){let e=d();l(4),_("ngModel",e.initialMinBalance),l(4),_("ngModel",e.initialMaxBalance)}}function Ae(s,o){if(s&1){let e=C();n(0,"div",15)(1,"label",37),r(2,"Balance:"),a(),n(3,"div",38)(4,"input",44),h("ngModelChange",function(t){p(e);let c=d();return f(c.initialMinBalance,t)||(c.initialMinBalance=t),m(t)}),a(),n(5,"label",45),r(6,"min $"),a()(),n(7,"div",38)(8,"input",46),h("ngModelChange",function(t){p(e);let c=d();return f(c.initialMaxBalance,t)||(c.initialMaxBalance=t),m(t)}),a(),n(9,"label",47),r(10,"max $"),a()(),n(11,"button",43),u("click",function(){p(e);let t=d();return m(t.apply())}),r(12," Apply "),a()()}if(s&2){let e=d();l(4),_("ngModel",e.initialMinBalance),l(4),_("ngModel",e.initialMaxBalance)}}function ke(s,o){if(s&1&&(n(0,"p"),r(1),R(2,"currency"),a()),s&2){let e=d().$implicit;l(),v(" ",ie(2,1,e.balance,"USD","symbol")," ")}}function ve(s,o){s&1&&(n(0,"p",58),r(1," Loading... "),a())}function Te(s,o){if(s&1){let e=C();n(0,"tr")(1,"td",48)(2,"div",30),B(3,"input",49)(4,"span",50),n(5,"p"),r(6),a()()(),n(7,"td",48)(8,"div",24)(9,"p"),r(10),a(),n(11,"span",51),r(12,"keyboard_arrow_down"),a()()(),n(13,"td",48)(14,"div",24)(15,"div",52)(16,"span",53),r(17,"T"),a()(),n(18,"p"),r(19),a(),n(20,"span",51),r(21,"keyboard_arrow_down"),a()()(),n(22,"td",48),X(23,ke,3,5,"p",54)(24,ve,2,0,"p",55),a(),n(25,"td",48)(26,"p"),r(27,"FIFO"),a()(),n(28,"td",48)(29,"p"),r(30),R(31,"date"),a()(),n(32,"td",48)(33,"span",56),u("click",function(){let t=p(e).$implicit,c=d();return m(c.editAccount(t))}),r(34,"edit"),a()(),n(35,"td",48)(36,"span",57),u("click",function(){let t=p(e).$implicit,c=d();return m(c.deleteAccount(t))}),r(37,"delete"),a()()()}if(s&2){let e=o.$implicit;l(6),v(" ",e.accountName," "),l(4),M(e.broker),l(9),M(e.server),l(4),g("ngIf",e.balance!==void 0),l(),g("ngIf",e.balance===void 0),l(6),v(" ",oe(31,6,e.createdAt.toDate(),"MM/dd/yyyy h:mm a")," ")}}function Se(s,o){if(s&1){let e=C();n(0,"app-show-confirmation",59),u("confirm",function(){p(e);let t=d();return m(t.confirmDelete())})("cancel",function(){p(e);let t=d();return m(t.cancelDelete())}),a()}if(s&2){let e=d();g("account",e.accountToDelete)}}var Y=class s{constructor(o){this.router=o}accounts=[];delete=new P;edit=new P;initialMinBalance=0;initialMaxBalance=1e6;showFilter=!1;currentPage=1;itemsPerPage=10;sortField="createdAt";sortAsc=!0;showConfirmation=!1;subscriptions=[];_searchTerm="";accountToDelete;get searchTerm(){return this._searchTerm}set searchTerm(o){this._searchTerm=o,this.goToPage(1)}get filteredUsers(){let o=this._searchTerm.trim().toLowerCase(),e=this.accounts.filter(i=>{let t=`${i.accountName}`.toLowerCase().includes(o),c=(i.balance??0)>=this.initialMinBalance,T=(i.balance??0)<=this.initialMaxBalance;return i.balance===void 0&&(c=!0,T=!0),this.showFilter?t:t&&c&&T});return e=e.sort((i,t)=>{let c=i[this.sortField]instanceof F?i[this.sortField].toDate().getTime():String(i[this.sortField]).toLowerCase(),T=t[this.sortField]instanceof F?t[this.sortField].toDate().getTime():String(t[this.sortField]).toLowerCase();return c<T?this.sortAsc?-1:1:c>T?this.sortAsc?1:-1:0}),e}get paginatedAccounts(){let o=(this.currentPage-1)*this.itemsPerPage,e=o+this.itemsPerPage;return this.filteredUsers.slice(o,e)}get totalPages(){return Math.ceil(this.filteredUsers.length/this.itemsPerPage)}statusClass(o){return o}returnClass(o){return o>=0?"green":"red"}openFilter(){this.showFilter=!this.showFilter}closeFilter(){this.showFilter=!1}apply(){this.showFilter=!1,this.applyFilters()}applyFilters(){this.goToPage(1)}goToPage(o){o<1&&(o=1),o>this.totalPages&&(o=this.totalPages),this.currentPage=o}prevPage(){this.goToPage(this.currentPage-1)}nextPage(){this.goToPage(this.currentPage+1)}toggleSort(){this.sortAsc=!this.sortAsc}getUserDate(o){return new Date(o)}deleteAccount(o){this.showConfirmation=!0,this.accountToDelete=o}editAccount(o){this.edit.emit(o)}confirmDelete(){this.delete.emit(this.accountToDelete),this.accountToDelete={},this.showConfirmation=!1}cancelDelete(){this.showConfirmation=!1,this.accountToDelete={}}ngOnInit(){this.loadAccountBalances()}ngOnChanges(o){o.accounts&&this.accounts&&this.accounts.length>0&&this.loadAccountBalances()}ngOnDestroy(){this.subscriptions.forEach(o=>o.unsubscribe())}loadAccountBalances(){}static \u0275fac=function(e){return new(e||s)(x(N))};static \u0275cmp=O({type:s,selectors:[["app-accounts-table"]],inputs:{accounts:"accounts"},outputs:{delete:"delete",edit:"edit"},features:[L],decls:92,vars:18,consts:[[1,"table-container","color-background","d-flex","flex-col","justify-between","p-24"],[1,"d-flex","flex-col"],[1,"accounts-header"],[1,"table-titles"],[1,"subtitle","mb-6"],[1,"table-actions-container","smallText","desktop-actions"],["onmouseover","this.style.border='1px solid rgba(158, 196, 242, 0.2)'","onmouseout","this.style.border=''",1,"search-user-container","d-flex","items-center","p-10","mr-10",2,"cursor","pointer","transition","all 0.2s ease"],["for","search-user",1,"mr-10"],[1,"material-symbols-outlined","color-background",2,"font-size","18px"],["id","search-account","type","text","placeholder","Search account",1,"search-box","color-background","smallText",3,"ngModelChange","ngModel"],["onmouseover","this.style.backgroundColor='rgba(158, 196, 242, 0.2)'; this.style.transform='translateY(-1px)'","onmouseout","this.style.backgroundColor=''; this.style.transform='translateY(0)'",1,"sort-Btn","regularText","color-secondary-300","p-10","mr-10",2,"cursor","pointer","transition","all 0.2s ease",3,"click"],["onmouseover","this.style.transform='rotate(180deg)'","onmouseout","this.style.transform='rotate(0deg)'",1,"material-symbols-outlined",2,"font-size","18px","transition","all 0.2s ease"],[1,"filter-container"],[1,"filter-btn","color-secondary-300","smallText","d-flex","items-center","p-10",3,"click"],[1,"material-symbols-outlined","color-secondary-300",2,"font-size","18px"],[1,"filter-modal","py-20","px-24","d-flex","flex-col"],[1,"mobile-actions"],["onmouseover","this.style.border='1px solid rgba(158, 196, 242, 0.2)'","onmouseout","this.style.border=''",1,"search-user-container","d-flex","items-center","p-10",2,"cursor","pointer","transition","all 0.2s ease"],["id","search-account-mobile","type","text","placeholder","Search account",1,"search-box","color-background","smallText",3,"ngModelChange","ngModel"],[1,"mobile-controls-row"],["onmouseover","this.style.backgroundColor='rgba(158, 196, 242, 0.2)'; this.style.transform='translateY(-1px)'","onmouseout","this.style.backgroundColor=''; this.style.transform='translateY(0)'",1,"sort-Btn","regularText","color-secondary-300","p-10",2,"cursor","pointer","transition","all 0.2s ease",3,"click"],[1,"table-scroll-container"],[1,"regularText"],[1,"regularText","py-18"],[1,"d-flex","items-center","gap-8"],[1,"icon-check-box"],[1,"pagination-controls","d-flex","justify-between","items-center","mt-10","regularText"],[1,"page-controls","d-flex","justify-between","items-center"],[1,"side-controls","d-flex","items-center"],[1,"regularText",3,"click","disabled"],[1,"d-flex","items-center"],[1,"d-flex","justify-between","items-center","mt-10"],["for","page-input",1,"regularText","mr-10","pb-2"],["id","page-input","type","number",1,"page-input","p-8","smallText","color-background",2,"width","4rem",3,"ngModelChange","change","min","max","ngModel"],[1,"color-secondary-300","smallText","mt-10","ml-20",3,"ngModelChange","change","ngModel"],[3,"value"],["message","Are you sure you want to delete this account?",3,"account"],[1,"mt-10"],[1,"percentage-input","d-flex","items-center","justify-between","p-10"],["id","min-balance","type","number","placeholder","Min Balance",1,"search-box","color-background","smallText",3,"ngModelChange","ngModel"],["for","min-balance"],["id","max-balance","type","number","placeholder","Max Balance",1,"search-box","color-background","smallText",3,"ngModelChange","ngModel"],["for","max-balance"],["onmouseover","this.style.backgroundColor='#8AE01A'; this.style.transform='translateY(-1px)'; this.style.boxShadow='0 4px 8px rgba(155, 245, 38, 0.3)'","onmouseout","this.style.backgroundColor=''; this.style.transform='translateY(0)'; this.style.boxShadow=''",1,"filter-btn","p-10","bg-primary-400","color-bg-black","inputText",2,"cursor","pointer","transition","all 0.2s ease",3,"click"],["id","min-balance-mobile","type","number","placeholder","Min Balance",1,"search-box","color-background","smallText",3,"ngModelChange","ngModel"],["for","min-balance-mobile"],["id","max-balance-mobile","type","number","placeholder","Max Balance",1,"search-box","color-background","smallText",3,"ngModelChange","ngModel"],["for","max-balance-mobile"],[1,"smallText"],["type","checkbox",1,"account-checkbox"],["title","Edit account name",1,"icon-edit","color-secondary-500","mr-12",2,"font-size","1rem"],["title","Broker options",1,"material-symbols-outlined","color-secondary-500",2,"font-size","24px"],[1,"broker-icon"],[1,"broker-letter"],[4,"ngIf"],["class","loading-text",4,"ngIf"],["title","Edit account","onmouseover","this.style.transform='scale(1.2)'; this.style.opacity='0.8'","onmouseout","this.style.transform='scale(1)'; this.style.opacity='1'",1,"material-symbols-outlined","color-secondary-500",2,"font-size","24px","cursor","pointer","transition","all 0.2s ease",3,"click"],["title","Delete account","onmouseover","this.style.transform='scale(1.2)'; this.style.opacity='0.8'","onmouseout","this.style.transform='scale(1)'; this.style.opacity='1'",1,"material-symbols-outlined","color-red",2,"font-size","24px","cursor","pointer","transition","all 0.2s ease",3,"click"],[1,"loading-text"],["message","Are you sure you want to delete this account?",3,"confirm","cancel","account"]],template:function(e,i){e&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h1",4),r(5,"Accounts"),a()(),n(6,"div",5)(7,"div",6)(8,"label",7)(9,"span",8),r(10,"search"),a()(),n(11,"input",9),h("ngModelChange",function(c){return f(i.searchTerm,c)||(i.searchTerm=c),c}),a()(),n(12,"button",10),u("click",function(){return i.toggleSort()}),n(13,"span",11),r(14,"swap_vert"),a(),r(15," Sort by: Last Update "),a(),n(16,"div",12)(17,"button",13),u("click",function(){return i.openFilter()}),n(18,"span",14),r(19,"filter_alt"),a(),r(20," Filter "),a(),y(21,Oe,13,2,"div",15),a()(),n(22,"div",16)(23,"div",17)(24,"label",7)(25,"span",8),r(26,"search"),a()(),n(27,"input",18),h("ngModelChange",function(c){return f(i.searchTerm,c)||(i.searchTerm=c),c}),a()(),n(28,"div",19)(29,"button",20),u("click",function(){return i.toggleSort()}),n(30,"span",11),r(31,"swap_vert"),a(),r(32," Sort by: Last Update "),a(),n(33,"div",12)(34,"button",13),u("click",function(){return i.openFilter()}),n(35,"span",14),r(36,"filter_alt"),a(),r(37," Filter "),a(),y(38,Ae,13,2,"div",15),a()()()(),n(39,"div",21)(40,"table",22)(41,"thead")(42,"tr")(43,"th",23)(44,"div",24),B(45,"span",25),n(46,"span"),r(47,"Account Name"),a()()(),n(48,"th",23),r(49,"Broker"),a(),n(50,"th",23),r(51,"Server"),a(),n(52,"th",23),r(53,"Balance"),a(),n(54,"th",23),r(55,"Profit calculation"),a(),n(56,"th",23),r(57,"Last update"),a(),n(58,"th",23),r(59,"Edit account"),a(),n(60,"th",23),r(61,"Delete account"),a()()(),n(62,"tbody"),$(63,Te,38,9,"tr",null,Z),a()()()(),n(65,"div",26)(66,"div",27)(67,"div",28)(68,"button",29),u("click",function(){return i.prevPage()}),r(69," < "),a(),n(70,"button",29),u("click",function(){return i.goToPage(1)}),r(71," << "),a()(),n(72,"span"),r(73),a(),n(74,"div",28)(75,"button",29),u("click",function(){return i.goToPage(i.totalPages)}),r(76," >> "),a(),n(77,"button",29),u("click",function(){return i.nextPage()}),r(78," > "),a()()(),n(79,"div",30)(80,"div",31)(81,"label",32),r(82,"Go to page"),a(),n(83,"input",33),h("ngModelChange",function(c){return f(i.currentPage,c)||(i.currentPage=c),c}),u("change",function(){return i.goToPage(i.currentPage)}),a()(),n(84,"select",34),h("ngModelChange",function(c){return f(i.itemsPerPage,c)||(i.itemsPerPage=c),c}),u("change",function(){return i.goToPage(1)}),n(85,"option",35),r(86,"5 items"),a(),n(87,"option",35),r(88,"10 items"),a(),n(89,"option",35),r(90,"25 items"),a()()()()(),y(91,Se,1,1,"app-show-confirmation",36)),e&2&&(l(11),_("ngModel",i.searchTerm),l(10),w(i.showFilter?21:-1),l(6),_("ngModel",i.searchTerm),l(11),w(i.showFilter?38:-1),l(25),ee(i.paginatedAccounts),l(5),g("disabled",i.currentPage===1),l(2),g("disabled",i.currentPage===1),l(3),ne("Page ",i.currentPage," of ",i.totalPages),l(2),g("disabled",i.currentPage===i.totalPages),l(2),g("disabled",i.currentPage===i.totalPages),l(6),g("min",1)("max",i.totalPages),_("ngModel",i.currentPage),l(),_("ngModel",i.itemsPerPage),l(),g("value",5),l(2),g("value",10),l(2),g("value",25),l(2),w(i.showConfirmation?91:-1))},dependencies:[A,ae,k,me,ge,S,z,pe,E,j,_e,D,U,ce,re],styles:[".table-container[_ngcontent-%COMP%]{background:radial-gradient(ellipse 36% 42% at top center,#5186e41a,#5186e403);border-radius:16px;border:.5px solid #434343;max-height:43rem;min-height:43rem}.table-container[_ngcontent-%COMP%]   .table-scroll-container[_ngcontent-%COMP%]{max-height:500px;position:relative;overflow-y:auto}.add-account-container[_ngcontent-%COMP%]{gap:2rem;margin-top:7rem}.add-account-container[_ngcontent-%COMP%]   .primary-btn[_ngcontent-%COMP%]{border-radius:.375rem;width:13rem;cursor:pointer;border:none;transition:background .2s}.add-account-container[_ngcontent-%COMP%]   .primary-btn[_ngcontent-%COMP%]:hover{background:#bcfe63!important}.search-box[_ngcontent-%COMP%]{background-color:transparent;border:none;display:flex;align-items:center;gap:8px;justify-content:center}.search-box[_ngcontent-%COMP%]:focus{outline:none}.search-box[_ngcontent-%COMP%]::placeholder{color:#cfd8dc}.search-user-container[_ngcontent-%COMP%], .percentage-input[_ngcontent-%COMP%]{border-radius:6px}.search-user-container[_ngcontent-%COMP%]{border:1px solid var(--White, #eaf2f8)}@media (max-width: 1024px){.search-user-container[_ngcontent-%COMP%]{width:100%}}.percentage-input[_ngcontent-%COMP%]{border:.5px solid #434343}.percentage-input[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{width:3rem}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;border-top:1px solid #2e3440}thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{position:sticky;top:-2px;background-color:#151516;z-index:10;border-bottom:1px solid #444}.table-scroll-container[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}.table-scroll-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#222b39;border-radius:6px}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{padding:10px 14px;text-align:left}tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid #2e3440}.status[_ngcontent-%COMP%]{border-radius:4px;width:100%}.purchased[_ngcontent-%COMP%]{background:#007aff26;color:#9fcdff}.pending[_ngcontent-%COMP%]{background:#ff950026;color:#ffc16b}.unverified[_ngcontent-%COMP%]{background:#49548626;color:#b5b4fd}.filter-btn[_ngcontent-%COMP%]{height:fit-content;border-radius:6px;border:none;cursor:pointer;text-decoration:none}.filter-modal[_ngcontent-%COMP%]{position:absolute;top:45px;right:0;background:radial-gradient(ellipse 36% 42% at top center,#5186e41a,#5186e403),#181a1d;border:.5px solid #4a4a4a;color:#e4e7ec;border-radius:6px;box-shadow:0 4px 16px #35353524;gap:16px;z-index:100}.filter-modal[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:500}.filter-modal[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{background:#181a1d;border:.5px solid #434343;border-radius:6px;padding:7px}.filter-modal[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{height:fit-content;border-radius:6px;border:none;cursor:pointer}.filter-container[_ngcontent-%COMP%]{position:relative}.filter-btn[_ngcontent-%COMP%]{border-radius:6px;background:#9ec4f21a;border:none;gap:10px;cursor:pointer;transition:background .2s}.filter-btn[_ngcontent-%COMP%]:hover{background:#232939}.progress-container[_ngcontent-%COMP%]{width:100%}.progress-bar-bg[_ngcontent-%COMP%]{width:100%;height:7px;border-radius:6px;background:#202621;position:relative;overflow:hidden}.progress-bar-fill[_ngcontent-%COMP%]{height:100%;border-radius:6px;background:#9bf526;transition:width .2s}.pagination-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:transparent;color:#5186e4;border:none;cursor:pointer}.pagination-controls[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{border-radius:.25rem;background:#9ec4f21a;border:none;padding:7px}.pagination-controls[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{background:#181a1d;border:none}.pagination-controls[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:focus{outline:none}.pagination-controls[_ngcontent-%COMP%]   .side-controls[_ngcontent-%COMP%]{gap:1.25rem}.pagination-controls[_ngcontent-%COMP%]   .page-controls[_ngcontent-%COMP%]{gap:1.625rem}.pagination-controls[_ngcontent-%COMP%]   .page-input[_ngcontent-%COMP%]{background:transparent;border-radius:6px;border:1px solid var(--White, #eaf2f8)}.pagination-controls[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%]::-webkit-inner-spin-button, .pagination-controls[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%]::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}.pagination-controls[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%]{appearance:textfield;-moz-appearance:textfield}.sort-Btn[_ngcontent-%COMP%]{border-radius:.375rem;background:#9ec4f21a;border:none;display:flex;align-items:center;gap:8px;justify-content:center}.account-checkbox[_ngcontent-%COMP%]{margin-right:8px;width:16px;height:16px;accent-color:#9BF526}.broker-icon[_ngcontent-%COMP%]{width:24px;height:24px;background:#1a1a1a;border-radius:50%;display:flex;align-items:center;justify-content:center;margin-right:8px}.broker-icon[_ngcontent-%COMP%]   .broker-letter[_ngcontent-%COMP%]{color:#e3e3e3;font-size:12px;font-weight:700}.upload-icon[_ngcontent-%COMP%], .clear-icon[_ngcontent-%COMP%]{cursor:pointer;font-size:16px;transition:opacity .2s ease;display:inline-block}.upload-icon[_ngcontent-%COMP%]:hover, .clear-icon[_ngcontent-%COMP%]:hover{opacity:.7}.add-account-btn[_ngcontent-%COMP%]{background:#9bf526;color:#2c2c2c;border:none;border-radius:8px;font-weight:600;font-size:14px;cursor:pointer;transition:all .2s ease;box-shadow:0 2px 4px #9bf5264d}.add-account-btn[_ngcontent-%COMP%]:hover{background:#8ae01a;transform:translateY(-1px);box-shadow:0 4px 8px #9bf52666}.add-account-btn[_ngcontent-%COMP%]:active{transform:translateY(0);box-shadow:0 2px 4px #9bf5264d}.add-account-btn[_ngcontent-%COMP%]   .icon-add-account[_ngcontent-%COMP%]{font-size:16px;font-weight:700}thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}table[_ngcontent-%COMP%]{min-width:1000px}.table-scroll-container[_ngcontent-%COMP%]{overflow-x:auto;overflow-y:auto;max-height:500px}th[_ngcontent-%COMP%]:nth-child(1), td[_ngcontent-%COMP%]:nth-child(1){width:200px}th[_ngcontent-%COMP%]:nth-child(2), td[_ngcontent-%COMP%]:nth-child(2){width:150px}th[_ngcontent-%COMP%]:nth-child(3), td[_ngcontent-%COMP%]:nth-child(3){width:100px}th[_ngcontent-%COMP%]:nth-child(4), td[_ngcontent-%COMP%]:nth-child(4){width:100px}th[_ngcontent-%COMP%]:nth-child(5), td[_ngcontent-%COMP%]:nth-child(5){width:120px}th[_ngcontent-%COMP%]:nth-child(6), td[_ngcontent-%COMP%]:nth-child(6){width:150px}th[_ngcontent-%COMP%]:nth-child(7), td[_ngcontent-%COMP%]:nth-child(7){width:100px}th[_ngcontent-%COMP%]:nth-child(8), td[_ngcontent-%COMP%]:nth-child(8){width:100px}th[_ngcontent-%COMP%]:nth-child(9), td[_ngcontent-%COMP%]:nth-child(9){width:80px}.loading-text[_ngcontent-%COMP%]{color:#9ca3af;font-style:italic;animation:_ngcontent-%COMP%_pulse 1.5s ease-in-out infinite}@keyframes _ngcontent-%COMP%_pulse{0%,to{opacity:1}50%{opacity:.5}}@media (max-width: 1024px){.accounts-header[_ngcontent-%COMP%]   .desktop-actions[_ngcontent-%COMP%]{display:none}.accounts-header[_ngcontent-%COMP%]   .mobile-actions[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:flex-start;width:100%;gap:8px;margin-top:12px;margin-bottom:12px}.accounts-header[_ngcontent-%COMP%]   .mobile-actions[_ngcontent-%COMP%]   .mobile-controls-row[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;width:100%}}@media (min-width: 1025px){.accounts-header[_ngcontent-%COMP%]   .mobile-actions[_ngcontent-%COMP%]{display:none}.accounts-header[_ngcontent-%COMP%]   .desktop-actions[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:flex-start;width:100%;margin-top:12px;margin-bottom:12px}}"]})};de();function De(s,o){if(s&1){let e=C();n(0,"div",1),u("click",function(){p(e);let t=d();return m(t.onClose())}),n(1,"div",2),u("click",function(t){return p(e),m(t.stopPropagation())}),n(2,"div",3)(3,"h2",4),r(4),a(),n(5,"button",5),u("click",function(){p(e);let t=d();return m(t.onClose())}),n(6,"span",6),r(7,"close"),a()()(),n(8,"div",7)(9,"div",8)(10,"div",9)(11,"label",10),r(12,"Account number"),a(),n(13,"input",11),h("ngModelChange",function(t){p(e);let c=d();return f(c.newAccount.accountNumber,t)||(c.newAccount.accountNumber=t),m(t)}),a()(),n(14,"div",9)(15,"label",10),r(16,"Account name*"),a(),n(17,"input",12),h("ngModelChange",function(t){p(e);let c=d();return f(c.newAccount.accountName,t)||(c.newAccount.accountName=t),m(t)}),a()(),n(18,"div",9)(19,"label",10),r(20,"Account ID*"),a(),n(21,"input",13),h("ngModelChange",function(t){p(e);let c=d();return f(c.newAccount.accountID,t)||(c.newAccount.accountID=t),m(t)}),a()(),n(22,"div",9)(23,"label",10),r(24,"Email trading account*"),a(),n(25,"input",14),h("ngModelChange",function(t){p(e);let c=d();return f(c.newAccount.emailTradingAccount,t)||(c.newAccount.emailTradingAccount=t),m(t)}),a()(),n(26,"div",9)(27,"label",10),r(28,"Password*"),a(),n(29,"input",15),h("ngModelChange",function(t){p(e);let c=d();return f(c.newAccount.brokerPassword,t)||(c.newAccount.brokerPassword=t),m(t)}),a()(),n(30,"div",9)(31,"label",10),r(32,"Broker*"),a(),n(33,"input",16),h("ngModelChange",function(t){p(e);let c=d();return f(c.newAccount.broker,t)||(c.newAccount.broker=t),m(t)}),a()(),n(34,"div",9)(35,"label",10),r(36,"Server*"),a(),n(37,"input",17),h("ngModelChange",function(t){p(e);let c=d();return f(c.newAccount.server,t)||(c.newAccount.server=t),m(t)}),a()(),n(38,"div",9)(39,"label",10),r(40),a(),n(41,"input",18),h("ngModelChange",function(t){p(e);let c=d();return f(c.newAccount.initialBalance,t)||(c.newAccount.initialBalance=t),m(t)}),a()()()(),n(42,"div",19)(43,"button",20),u("click",function(){p(e);let t=d();return m(t.onCancel())}),r(44," Cancel "),a(),n(45,"button",21),u("click",function(){p(e);let t=d();return m(t.onCreate())}),r(46),a()()()()}if(s&2){let e=d();l(4),M(e.editMode?"Edit Trading Account":"Create Trading Account"),l(9),_("ngModel",e.newAccount.accountNumber),l(4),_("ngModel",e.newAccount.accountName),l(4),_("ngModel",e.newAccount.accountID),l(4),_("ngModel",e.newAccount.emailTradingAccount),l(4),_("ngModel",e.newAccount.brokerPassword),l(4),_("ngModel",e.newAccount.broker),l(4),_("ngModel",e.newAccount.server),l(3),M(e.editMode?"Initial Balance":"Initial Balance*"),l(),V("readonly",e.editMode),_("ngModel",e.newAccount.initialBalance),g("readonly",e.editMode),l(5),v(" ",e.editMode?"Update trading account":"Create trading account"," ")}}function Be(s,o){if(s&1){let e=C();n(0,"div",1),u("click",function(){p(e);let t=d();return m(t.onContinueEditing())}),n(1,"div",22),u("click",function(t){return p(e),m(t.stopPropagation())}),n(2,"div",3)(3,"h2",4),r(4),a()(),n(5,"div",7)(6,"p",23),r(7),a()(),n(8,"div",19)(9,"button",24),u("click",function(){p(e);let t=d();return m(t.onContinueEditing())}),r(10),a(),n(11,"button",25),u("click",function(){p(e);let t=d();return m(t.onConfirmCancel())}),r(12," Yes, cancel "),a()()()()}if(s&2){let e=d();l(4),M(e.editMode?"Cancel trading account update?":"Cancel trading account creation?"),l(3),M(e.editMode?"If you leave now, your changes will not be saved.":"If you leave now, the information you've entered will not be saved."),l(3),v(" Continue ",e.editMode?"editing":"creating"," ")}}function Ve(s,o){if(s&1){let e=C();n(0,"div",1),u("click",function(){p(e);let t=d();return m(t.onGoToList())}),n(1,"div",26),u("click",function(t){return p(e),m(t.stopPropagation())}),n(2,"div",3)(3,"h2",4),r(4),a()(),n(5,"div",7)(6,"p",23),r(7),a()(),n(8,"div",19)(9,"button",27),u("click",function(){p(e);let t=d();return m(t.onGoToList())}),r(10," Go to trading account list "),a()()()()}if(s&2){let e=d();l(4),M(e.editMode?"Trading account updated successfully":"Trading account created successfully"),l(3),M(e.editMode?"The account has been updated successfully.":"The new account has been added to your list and can now access it.")}}var G=class s{constructor(o,e){this.authService=o;this.tradeLockerApiService=e}visible=!1;userId="";currentAccountCount=0;editMode=!1;accountToEdit=null;close=new P;create=new P;update=new P;cancel=new P;ngOnChanges(o){o.visible&&o.visible.currentValue===!0&&(this.editMode&&this.accountToEdit?this.populateFormForEdit():this.resetForm())}newAccount={emailTradingAccount:"",brokerPassword:"",accountName:"",broker:"",server:"",accountID:"",initialBalance:0,accountNumber:0};showCancelConfirm=!1;showSuccessModal=!1;onClose(){this.close.emit()}onCancel(){this.showCancelConfirm=!0}onConfirmCancel(){this.showCancelConfirm=!1,this.cancel.emit()}onContinueEditing(){this.showCancelConfirm=!1}onCreate(){return b(this,null,function*(){if(!this.newAccount.accountName||!this.newAccount.broker||!this.newAccount.emailTradingAccount||!this.newAccount.brokerPassword||!this.newAccount.server||!this.newAccount.accountID||!this.newAccount.accountNumber){alert("Please fill in all required fields.");return}try{if(!(yield this.validateAccountInTradeLocker())){alert("Account does not exist in TradeLocker. Please verify the credentials.");return}let e=yield this.validateAccountUniqueness();if(!e.isValid){alert(e.message);return}this.editMode&&this.accountToEdit?yield this.updateAccount():yield this.createNewAccount()}catch(o){console.error("Error processing trading account:",o),alert(`Failed to ${this.editMode?"update":"create"} trading account. Please try again.`)}})}createNewAccount(){return b(this,null,function*(){let o=this.createAccountObject();yield this.authService.createAccount(o),this.showSuccessModal=!0,this.create.emit(o)})}updateAccount(){return b(this,null,function*(){if(!this.accountToEdit)return;let o=J(H({},this.accountToEdit),{accountName:this.newAccount.accountName,broker:this.newAccount.broker,server:this.newAccount.server,emailTradingAccount:this.newAccount.emailTradingAccount,brokerPassword:this.newAccount.brokerPassword,accountID:this.newAccount.accountID,accountNumber:this.newAccount.accountNumber,initialBalance:this.newAccount.initialBalance});yield this.authService.updateAccount(this.accountToEdit.id,o),this.showSuccessModal=!0,this.update.emit(o)})}onGoToList(){this.showSuccessModal=!1,this.close.emit()}resetForm(){this.newAccount={accountName:"",broker:"",server:"",emailTradingAccount:"",brokerPassword:"",accountID:"",accountNumber:1,initialBalance:0}}populateFormForEdit(){this.accountToEdit&&(this.newAccount={accountName:this.accountToEdit.accountName||"",broker:this.accountToEdit.broker||"",server:this.accountToEdit.server||"",emailTradingAccount:this.accountToEdit.emailTradingAccount||"",brokerPassword:this.accountToEdit.brokerPassword||"",accountID:this.accountToEdit.accountID||"",accountNumber:this.accountToEdit.accountNumber||1,initialBalance:this.accountToEdit.initialBalance||0})}createAccountObject(){let o=Date.now().toString(36),e=Math.random().toString(36).substring(2,8);return{id:`id_${o}_${e}`,userId:this.userId,emailTradingAccount:this.newAccount.emailTradingAccount,brokerPassword:this.newAccount.brokerPassword,broker:this.newAccount.broker,server:this.newAccount.server,accountName:this.newAccount.accountName,accountID:this.newAccount.accountID,accountNumber:this.newAccount.accountNumber,initialBalance:this.newAccount.initialBalance,createdAt:F.now()}}validateAccountInTradeLocker(){return b(this,null,function*(){try{return yield this.tradeLockerApiService.validateAccount({email:this.newAccount.emailTradingAccount,password:this.newAccount.brokerPassword,server:this.newAccount.server})}catch(o){return console.error("Error validating account in TradeLocker:",o),!1}})}validateAccountUniqueness(){return b(this,null,function*(){try{return(yield this.authService.checkAccountExists(this.newAccount.broker,this.newAccount.server,this.newAccount.accountID,this.userId))?{isValid:!1,message:"This account is already registered. Try with another account or delete the existing trade account it is linked to."}:{isValid:!0,message:""}}catch{return{isValid:!1,message:"This account is already registered. Try with another account or delete the existing trade account it is linked to."}}})}static \u0275fac=function(e){return new(e||s)(x(W),x(he))};static \u0275cmp=O({type:s,selectors:[["app-create-account-popup"]],inputs:{visible:"visible",userId:"userId",currentAccountCount:"currentAccountCount",editMode:"editMode",accountToEdit:"accountToEdit"},outputs:{close:"close",create:"create",update:"update",cancel:"cancel"},features:[L],decls:3,vars:3,consts:[[1,"modal-overlay"],[1,"modal-overlay",3,"click"],[1,"create-account-modal",3,"click"],[1,"modal-header"],[1,"modal-title"],[1,"modal-close",3,"click"],[1,"material-symbols-outlined"],[1,"modal-body"],[1,"form-grid"],[1,"form-group"],[1,"form-label"],["type","number","placeholder","Enter the account number you have in the trade, normally it's 1","min","1",1,"form-input",3,"ngModelChange","ngModel"],["type","text","placeholder","Account name",1,"form-input",3,"ngModelChange","ngModel"],["type","text","placeholder","Account ID",1,"form-input",3,"ngModelChange","ngModel"],["type","text","placeholder","Email trading account",1,"form-input",3,"ngModelChange","ngModel"],["type","text","placeholder","Password",1,"form-input",3,"ngModelChange","ngModel"],["type","text","placeholder","Enter broker name (e.g., TradeLocker)",1,"form-input",3,"ngModelChange","ngModel"],["type","text","placeholder","Server",1,"form-input",3,"ngModelChange","ngModel"],["type","number","placeholder","Balance",1,"form-input",3,"ngModelChange","ngModel","readonly"],[1,"modal-footer"],[1,"cancel-btn",3,"click"],[1,"create-btn",3,"click"],[1,"confirm-modal",3,"click"],[1,"modal-message"],[1,"continue-btn",3,"click"],[1,"confirm-cancel-btn",3,"click"],[1,"success-modal",3,"click"],[1,"success-btn",3,"click"]],template:function(e,i){e&1&&(y(0,De,47,14,"div",0),y(1,Be,13,3,"div",0),y(2,Ve,11,2,"div",0)),e&2&&(w(i.visible?0:-1),l(),w(i.showCancelConfirm?1:-1),l(),w(i.showSuccessModal?2:-1))},dependencies:[A,k,S,z,E,j,D],styles:[".modal-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#000000b3;display:flex;align-items:center;justify-content:center;z-index:1000;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px)}.create-account-modal[_ngcontent-%COMP%]{background:#2a2a2a;border-radius:12px;width:90%;max-width:800px;box-shadow:0 20px 40px #00000080;border:1px solid #4a4a4a}.create-account-modal[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;padding:24px 24px 0}.create-account-modal[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]   .modal-title[_ngcontent-%COMP%]{color:#fff;font-size:20px;font-weight:700;margin:0;line-height:1.3;flex:1;font-family:SF Pro Display,-apple-system,BlinkMacSystemFont,sans-serif}.create-account-modal[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]   .modal-close[_ngcontent-%COMP%]{background:none;border:none;color:#3b71ca;cursor:pointer;padding:4px;border-radius:4px;transition:all .2s ease;margin-left:16px;font-size:18px;font-weight:700}.create-account-modal[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]   .modal-close[_ngcontent-%COMP%]:hover{color:#335285}.create-account-modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]{padding:20px 24px 24px}.create-account-modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;gap:20px}@media (min-width: 768px){.create-account-modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-grid[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr;gap:20px 24px}}.create-account-modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}.create-account-modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .form-label[_ngcontent-%COMP%]{display:block;color:#fff;font-size:14px;font-weight:500;font-family:SF Pro Display,-apple-system,BlinkMacSystemFont,sans-serif}.create-account-modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]{width:100%;background:#1a1a1a;border:1px solid #4a4a4a;border-radius:8px;padding:12px 16px;color:#fff;font-size:14px;font-family:SF Pro Display,-apple-system,BlinkMacSystemFont,sans-serif}.create-account-modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]::placeholder{color:#8e8e93}.create-account-modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]:focus{border-color:#9bf526;outline:none}.create-account-modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .form-input.readonly[_ngcontent-%COMP%]{background:#2a2a2a;border-color:#3a3a3a;color:#8e8e93;cursor:not-allowed}.create-account-modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .form-input.readonly[_ngcontent-%COMP%]:focus{border-color:#3a3a3a}.create-account-modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .form-textarea[_ngcontent-%COMP%]{width:100%;background:#1a1a1a;border:1px solid #4a4a4a;border-radius:8px;padding:12px 16px;color:#fff;font-size:14px;font-family:SF Pro Display,-apple-system,BlinkMacSystemFont,sans-serif;resize:vertical;min-height:80px}.create-account-modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .form-textarea[_ngcontent-%COMP%]::placeholder{color:#8e8e93}.create-account-modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .form-textarea[_ngcontent-%COMP%]:focus{border-color:#9bf526;outline:none}.create-account-modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .form-select-wrapper[_ngcontent-%COMP%]{position:relative}.create-account-modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .form-select-wrapper[_ngcontent-%COMP%]   .form-select[_ngcontent-%COMP%]{width:100%;background:#1a1a1a;border:1px solid #4a4a4a;border-radius:8px;padding:12px 40px 12px 16px;color:#fff;font-size:14px;font-family:SF Pro Display,-apple-system,BlinkMacSystemFont,sans-serif;appearance:none;cursor:pointer}.create-account-modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .form-select-wrapper[_ngcontent-%COMP%]   .form-select[_ngcontent-%COMP%]:focus{border-color:#9bf526;outline:none}.create-account-modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .form-select-wrapper[_ngcontent-%COMP%]   .select-arrow[_ngcontent-%COMP%]{position:absolute;right:12px;top:50%;transform:translateY(-50%);color:#8e8e93;pointer-events:none;font-size:12px}.create-account-modal[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%]{padding:12px 24px 24px;display:flex;justify-content:flex-end;gap:12px}.create-account-modal[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%]   .cancel-btn[_ngcontent-%COMP%]{background:#bcfe631a;color:#9bf526;border:1px solid #9BF526;border-radius:8px;padding:12px 18px;font-size:14px;font-weight:600;font-family:SF Pro Display,-apple-system,BlinkMacSystemFont,sans-serif;cursor:pointer;transition:all .2s ease}.create-account-modal[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%]   .cancel-btn[_ngcontent-%COMP%]:hover{color:#6d9b32;border:1px solid #6d9b32}.create-account-modal[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%]   .create-btn[_ngcontent-%COMP%]{background:#9bf526;color:#1a1a1a;border:none;border-radius:8px;padding:12px 18px;font-size:14px;font-weight:600;font-family:SF Pro Display,-apple-system,BlinkMacSystemFont,sans-serif;cursor:pointer;transition:all .2s ease}.create-account-modal[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%]   .create-btn[_ngcontent-%COMP%]:hover{background:#8ae01a;transform:translateY(-1px);box-shadow:0 4px 12px #9bf5264d}.create-account-modal[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%]   .create-btn[_ngcontent-%COMP%]:active{transform:translateY(0)}.confirm-modal[_ngcontent-%COMP%]{background:#2a2a2a;border-radius:12px;width:90%;max-width:400px;box-shadow:0 20px 40px #00000080;border:1px solid #4a4a4a}.confirm-modal[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]{padding:24px 24px 0}.confirm-modal[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]   .modal-title[_ngcontent-%COMP%]{color:#fff;font-size:18px;font-weight:700;margin:0;line-height:1.3;font-family:SF Pro Display,-apple-system,BlinkMacSystemFont,sans-serif}.confirm-modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]{padding:20px 24px}.confirm-modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .modal-message[_ngcontent-%COMP%]{color:#fff;font-size:14px;line-height:1.5;margin:0;font-family:SF Pro Display,-apple-system,BlinkMacSystemFont,sans-serif}.confirm-modal[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%]{padding:0 24px 24px;display:flex;gap:12px}.confirm-modal[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%]   .continue-btn[_ngcontent-%COMP%]{flex:1;background:transparent;color:#fff;border:1px solid #4a4a4a;border-radius:8px;padding:12px 18px;font-size:14px;font-weight:600;font-family:SF Pro Display,-apple-system,BlinkMacSystemFont,sans-serif;cursor:pointer;transition:all .2s ease}.confirm-modal[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%]   .continue-btn[_ngcontent-%COMP%]:hover{background:#ffffff1a;border-color:#6a6a6a}.confirm-modal[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%]   .confirm-cancel-btn[_ngcontent-%COMP%]{flex:1;background:#ff3b30;color:#fff;border:none;border-radius:8px;padding:12px 18px;font-size:14px;font-weight:600;font-family:SF Pro Display,-apple-system,BlinkMacSystemFont,sans-serif;cursor:pointer;transition:all .2s ease}.confirm-modal[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%]   .confirm-cancel-btn[_ngcontent-%COMP%]:hover{background:#ff2d55;transform:translateY(-1px)}.confirm-modal[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%]   .confirm-cancel-btn[_ngcontent-%COMP%]:active{transform:translateY(0)}.success-modal[_ngcontent-%COMP%]{background:#2a2a2a;border-radius:12px;width:90%;max-width:400px;box-shadow:0 20px 40px #00000080;border:1px solid #4a4a4a}.success-modal[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]{padding:24px 24px 0}.success-modal[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]   .modal-title[_ngcontent-%COMP%]{color:#fff;font-size:18px;font-weight:700;margin:0;line-height:1.3;font-family:SF Pro Display,-apple-system,BlinkMacSystemFont,sans-serif}.success-modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]{padding:20px 24px}.success-modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .modal-message[_ngcontent-%COMP%]{color:#fff;font-size:14px;line-height:1.5;margin:0;font-family:SF Pro Display,-apple-system,BlinkMacSystemFont,sans-serif}.success-modal[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%]{padding:0 24px 24px}.success-modal[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%]   .success-btn[_ngcontent-%COMP%]{width:100%;background:#9bf526;color:#1a1a1a;border:none;border-radius:8px;padding:12px 18px;font-size:14px;font-weight:600;font-family:SF Pro Display,-apple-system,BlinkMacSystemFont,sans-serif;cursor:pointer;transition:all .2s ease}.success-modal[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%]   .success-btn[_ngcontent-%COMP%]:hover{background:#8ae01a;transform:translateY(-1px);box-shadow:0 4px 12px #9bf5264d}.success-modal[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%]   .success-btn[_ngcontent-%COMP%]:active{transform:translateY(0)}"]})};function Fe(s,o){if(s&1){let e=C();n(0,"div",14)(1,"div",15)(2,"div",16)(3,"span",4),r(4,"info"),a()(),n(5,"div",17)(6,"span"),r(7),a(),n(8,"span",18),u("click",function(){p(e);let t=d();return m(t.onUpgradePlan())}),r(9,"Upgrade anytime."),a()(),n(10,"button",19),u("click",function(){p(e);let t=d();return m(t.onCloseBanner())}),n(11,"span",4),r(12,"close"),a()()()()}if(s&2){let e=d();te("plan-banner-"+e.planBannerType),l(7),M(e.planBannerMessage)}}function Ie(s,o){if(s&1){let e=C();n(0,"app-accounts-table",20),u("delete",function(t){p(e);let c=d();return m(c.deleteAccount(t))})("edit",function(t){p(e);let c=d();return m(c.onEditAccount(t))}),a()}if(s&2){let e=d();g("accounts",e.usersData)}}function Le(s,o){if(s&1){let e=C();n(0,"div",10)(1,"div",21)(2,"span",22),r(3,"group_add"),a()(),n(4,"h3",23),r(5,"No trading accounts found"),a(),n(6,"p",24),r(7,"You need to add a trading account before creating strategies."),a(),n(8,"button",25),u("click",function(){p(e);let t=d();return m(t.onAddAccount())}),r(9," Add Trading Account "),a()()}}var ye=class s{constructor(o,e,i,t,c,T){this.store=o;this.reportSvc=e;this.userSvc=i;this.router=t;this.planLimitationsGuard=c;this.appContext=T}user=null;userKey="";fromDate="";toDate="";loading=!1;usersData=[];showAddAccountModal=!1;editMode=!1;accountToEdit=null;planLimitationModal={showModal:!1,modalType:"upgrade",title:"",message:"",primaryButtonText:"",onPrimaryAction:()=>{}};isAddAccountDisabled=!1;showPlanBanner=!1;planBannerMessage="";planBannerType="info";ngOnInit(){this.subscribeToContextData(),this.store.select(se).subscribe(o=>{this.user=o?.user??null,this.loadConfig()})}subscribeToContextData(){this.appContext.currentUser$.subscribe(o=>{this.user=o}),this.appContext.userAccounts$.subscribe(o=>{this.usersData=o}),this.appContext.isLoading$.subscribe(o=>{this.loading=o.accounts}),this.appContext.errors$.subscribe(o=>{o.accounts&&console.error("Error en cuentas:",o.accounts)})}loadConfig(){this.getUserAccounts()}getUserAccounts(){this.userSvc.getUserAccounts(this.user?.id||"").then(o=>{o&&o.length>0?(this.usersData=o,this.loading=!1,this.getBalanceForAccounts()):(this.usersData=[],this.loading=!1),this.checkAccountLimitations()}).catch(o=>{this.loading=!1,console.error("Error to get the config",o)})}getBalanceForAccounts(){this.loading=!0,Q(this.usersData).pipe(I(o=>this.fetchUserKey(o))).subscribe({next:()=>{},complete:()=>{this.loading=!1},error:o=>{this.loading=!1,console.error("Error en el proceso de actualizaci\xF3n de balances",o)}})}fetchUserKey(o){return this.reportSvc.getUserKey(o.emailTradingAccount,o.brokerPassword,o.server).pipe(I(e=>(this.store.dispatch(fe({userKey:e})),this.getActualBalance(e,o))))}getActualBalance(o,e){return this.reportSvc.getBalanceData(e.accountID,o,1).pipe(I(i=>(e.balance=i.balance||0,[e])))}deleteAccount(o){this.loading=!0,this.userSvc.deleteAccount(o.id).then(()=>b(this,null,function*(){this.loading=!1,this.loadConfig(),yield this.checkPlanLimitations(),this.usersData=[...this.usersData]})).catch(e=>{this.loading=!1,console.error("Error deleting account",e)})}onAddAccount(){return b(this,null,function*(){if(!this.user?.id||this.isAddAccountDisabled)return;let o=this.usersData.length,e=yield this.planLimitationsGuard.checkAccountCreationWithModal(this.user.id,o);if(!e.canCreate){e.modalData&&(this.planLimitationModal=e.modalData);return}this.editMode=!1,this.accountToEdit=null,this.showAddAccountModal=!0})}onEditAccount(o){this.editMode=!0,this.accountToEdit=o,this.showAddAccountModal=!0}onCloseAddAccountModal(){this.showAddAccountModal=!1,this.editMode=!1,this.accountToEdit=null}onAccountCanceled(){this.showAddAccountModal=!1,this.editMode=!1,this.accountToEdit=null}onClosePlanLimitationModal(){this.planLimitationModal.showModal=!1}checkAccountLimitations(){return b(this,null,function*(){if(!this.user?.id){this.isAddAccountDisabled=!0;return}try{let o=this.usersData.length,e=yield this.planLimitationsGuard.checkAccountCreationWithModal(this.user.id,o);this.isAddAccountDisabled=!e.canCreate,e.modalData&&(this.planLimitationModal=e.modalData),yield this.checkPlanLimitations()}catch(o){console.error("Error checking account limitations:",o),this.isAddAccountDisabled=!0}})}checkPlanLimitations(){return b(this,null,function*(){if(!this.user?.id){this.showPlanBanner=!1;return}try{let o=yield this.planLimitationsGuard.checkUserLimitations(this.user.id),e=this.usersData.length;if(this.showPlanBanner=!1,this.planBannerMessage="",this.planBannerType="info",o.needsSubscription||o.isBanned||o.isCancelled){this.showPlanBanner=!0,this.planBannerMessage=this.getBlockedMessage(o),this.planBannerType="warning";return}e>=o.maxAccounts?(this.showPlanBanner=!0,this.planBannerMessage=`You've reached the account limit for your ${o.planName} plan. Move to a higher plan and keep growing your account.`,this.planBannerType="warning"):e>=o.maxAccounts-1&&(this.showPlanBanner=!0,this.planBannerMessage=`You have ${o.maxAccounts-e} accounts left on your current plan. Want more? Upgrade anytime.`,this.planBannerType="info")}catch(o){console.error("Error checking plan limitations:",o),this.showPlanBanner=!1}})}getBlockedMessage(o){return o.isBanned?"Your account has been banned. Please contact support for assistance.":o.isCancelled?"Your subscription has been cancelled. Please purchase a plan to access this functionality.":o.needsSubscription?"You need to purchase a plan to access this functionality.":"Access denied. Please contact support for assistance."}onUpgradePlan(){this.router.navigate(["/account"])}onCloseBanner(){this.showPlanBanner=!1}onAccountCreated(o){return b(this,null,function*(){this.loadConfig(),yield this.checkPlanLimitations()})}onAccountUpdated(o){return b(this,null,function*(){this.loadConfig(),yield this.checkPlanLimitations()})}static \u0275fac=function(e){return new(e||s)(x(le),x(be),x(W),x(N),x(Ce),x(ue))};static \u0275cmp=O({type:s,selectors:[["app-trading-accounts"]],decls:23,vars:15,consts:[[1,"main-titles","color-background","d-flex","flex-col","mb-32"],[1,"d-flex","justify-between","align-items-center","mb-12"],[1,"titleText"],[1,"add-account-header-btn","desktop-add-btn",3,"click","disabled"],[1,"material-symbols-outlined",2,"font-size","20px"],[1,"regularText"],[1,"add-account-mobile-btn","mobile-add-btn",3,"click","disabled"],[1,"plan-banner",3,"class"],[1,"middle-container","justify-between","d-flex","mb-24"],[3,"accounts"],[1,"empty-strategies","d-flex","flex-col","align-items-center"],[3,"visible"],[3,"close","create","update","cancel","visible","userId","currentAccountCount","editMode","accountToEdit"],[3,"closeModal","modalData"],[1,"plan-banner"],[1,"banner-content"],[1,"banner-icon"],[1,"banner-message"],[1,"upgrade-link",3,"click"],[1,"banner-close",3,"click"],[3,"delete","edit","accounts"],[1,"empty-icon"],[1,"material-symbols-outlined",2,"font-size","28px"],[1,"empty-title"],[1,"empty-description"],[1,"create-first-btn",3,"click"]],template:function(e,i){e&1&&(n(0,"div",0)(1,"div",1)(2,"h1",2),r(3,"My Trading Accounts"),a(),n(4,"button",3),u("click",function(){return i.isAddAccountDisabled?null:i.onAddAccount()}),n(5,"span",4),r(6,"add"),a(),n(7,"span"),r(8,"Add Account"),a()()(),n(9,"h3",5),r(10," View and manage all your connected trading accounts in one place. "),a(),n(11,"button",6),u("click",function(){return i.isAddAccountDisabled?null:i.onAddAccount()}),n(12,"span",4),r(13,"add"),a(),n(14,"span"),r(15,"Add Account"),a()()(),y(16,Fe,13,3,"div",7),n(17,"div",8),y(18,Ie,1,1,"app-accounts-table",9)(19,Le,10,0,"div",10),a(),B(20,"app-loading-popup",11),n(21,"app-create-account-popup",12),u("close",function(){return i.onCloseAddAccountModal()})("create",function(c){return i.onAccountCreated(c)})("update",function(c){return i.onAccountUpdated(c)})("cancel",function(){return i.onAccountCanceled()}),a(),n(22,"app-plan-limitation-modal",13),u("closeModal",function(){return i.onClosePlanLimitationModal()}),a()),e&2&&(l(4),V("disabled",i.isAddAccountDisabled),g("disabled",i.isAddAccountDisabled),l(7),V("disabled",i.isAddAccountDisabled),g("disabled",i.isAddAccountDisabled),l(5),w(i.showPlanBanner?16:-1),l(2),w(i.usersData&&i.usersData.length>0?18:i.loading?-1:19),l(2),g("visible",i.loading),l(),g("visible",i.showAddAccountModal)("userId",(i.user==null?null:i.user.id)||"")("currentAccountCount",i.usersData.length)("editMode",i.editMode)("accountToEdit",i.accountToEdit),l(),g("modalData",i.planLimitationModal))},dependencies:[A,xe,k,Y,G,Me],styles:['app-accounts-table[_ngcontent-%COMP%]{width:100%}.accounts-header[_ngcontent-%COMP%]{background:transparent;padding:0;margin-bottom:32px}.subtitle[_ngcontent-%COMP%]{font-size:24px;font-weight:500;color:#e3e3e3}.empty-strategies[_ngcontent-%COMP%]{width:100%;height:100%;text-align:center;align-items:center;justify-content:center;padding:40px 20px}.empty-strategies[_ngcontent-%COMP%]   .empty-icon[_ngcontent-%COMP%]{width:64px;height:64px;background:#2a2a2a;border-radius:50%;display:flex;align-items:center;justify-content:center;margin:0 auto 16px}.empty-strategies[_ngcontent-%COMP%]   .empty-icon[_ngcontent-%COMP%]   .material-symbols-outlined[_ngcontent-%COMP%]{font-size:28px;color:#fff}.empty-strategies[_ngcontent-%COMP%]   .empty-title[_ngcontent-%COMP%]{color:#e3e3e3;font-family:SF Pro Display,-apple-system,BlinkMacSystemFont,sans-serif;font-size:18px;font-weight:600;margin:0 0 8px}.empty-strategies[_ngcontent-%COMP%]   .empty-description[_ngcontent-%COMP%]{color:#8e8e93;font-family:SF Pro Display,-apple-system,BlinkMacSystemFont,sans-serif;font-size:14px;font-weight:400;margin:0 0 20px;line-height:1.5}.empty-strategies[_ngcontent-%COMP%]   .create-first-btn[_ngcontent-%COMP%]{background:#9bf526;color:#1a1a1a;border:none;border-radius:8px;padding:12px 24px;font-family:SF Pro Display,-apple-system,BlinkMacSystemFont,sans-serif;font-size:14px;font-weight:600;cursor:pointer;transition:all .2s ease}.empty-strategies[_ngcontent-%COMP%]   .create-first-btn[_ngcontent-%COMP%]:hover{background:#8ae01a;transform:translateY(-1px);box-shadow:0 4px 12px #9bf5264d}.plan-banner[_ngcontent-%COMP%]{width:100%;margin-bottom:20px;border-radius:8px;border:1px solid;background:#3b71ca1a}.plan-banner.plan-banner-info[_ngcontent-%COMP%]{border-color:#3b71ca;background:#3b71ca1a}.plan-banner.plan-banner-warning[_ngcontent-%COMP%]{border-color:#ff9500;background:#ff95001a}.plan-banner.plan-banner-success[_ngcontent-%COMP%]{border-color:#34c759;background:#34c7591a}.plan-banner[_ngcontent-%COMP%]   .banner-content[_ngcontent-%COMP%]{display:flex;align-items:center;padding:16px 20px;gap:12px}.plan-banner[_ngcontent-%COMP%]   .banner-content[_ngcontent-%COMP%]   .banner-icon[_ngcontent-%COMP%]{flex-shrink:0;width:20px;height:20px;border-radius:50%;background:#3b71ca;display:flex;align-items:center;justify-content:center}.plan-banner[_ngcontent-%COMP%]   .banner-content[_ngcontent-%COMP%]   .banner-icon[_ngcontent-%COMP%]   .icon-info[_ngcontent-%COMP%]{color:#fff;font-size:12px;font-weight:700}.plan-banner[_ngcontent-%COMP%]   .banner-content[_ngcontent-%COMP%]   .banner-icon[_ngcontent-%COMP%]   .icon-info[_ngcontent-%COMP%]:before{content:"i";font-family:Arial,sans-serif}.plan-banner[_ngcontent-%COMP%]   .banner-content[_ngcontent-%COMP%]   .banner-message[_ngcontent-%COMP%]{flex:1;color:#e3e3e3;font-size:14px;line-height:1.4}.plan-banner[_ngcontent-%COMP%]   .banner-content[_ngcontent-%COMP%]   .banner-message[_ngcontent-%COMP%]   .upgrade-link[_ngcontent-%COMP%]{color:#3b71ca;text-decoration:underline;cursor:pointer;font-weight:500}.plan-banner[_ngcontent-%COMP%]   .banner-content[_ngcontent-%COMP%]   .banner-message[_ngcontent-%COMP%]   .upgrade-link[_ngcontent-%COMP%]:hover{color:#5b8cff}.plan-banner[_ngcontent-%COMP%]   .banner-content[_ngcontent-%COMP%]   .banner-close[_ngcontent-%COMP%]{flex-shrink:0;background:none;border:none;color:#8e8e93;cursor:pointer;padding:4px;border-radius:4px;transition:all .2s ease}.plan-banner[_ngcontent-%COMP%]   .banner-content[_ngcontent-%COMP%]   .banner-close[_ngcontent-%COMP%]:hover{background:#ffffff1a;color:#e3e3e3}.plan-banner[_ngcontent-%COMP%]   .banner-content[_ngcontent-%COMP%]   .banner-close[_ngcontent-%COMP%]   .icon-close[_ngcontent-%COMP%]{font-size:16px;font-weight:700;line-height:1}.add-account-header-btn[_ngcontent-%COMP%]{background:#9bf526;color:#1a1a1a;border:none;border-radius:8px;padding:12px 20px;font-size:14px;font-weight:600;cursor:pointer;transition:all .2s ease;display:flex;align-items:center;gap:8px}.add-account-header-btn[_ngcontent-%COMP%]:hover{background:#8ae01a;transform:translateY(-1px);box-shadow:0 4px 12px #9bf5264d}.add-account-header-btn[_ngcontent-%COMP%]:active{transform:translateY(0)}.add-account-header-btn.disabled[_ngcontent-%COMP%]{background:#4a4a4a;color:#8e8e93;cursor:not-allowed;opacity:.6}.add-account-header-btn.disabled[_ngcontent-%COMP%]:hover{background:#4a4a4a;transform:none;box-shadow:none}.add-account-header-btn[_ngcontent-%COMP%]   .icon-plus[_ngcontent-%COMP%]{font-size:16px;font-family:icomoon!important;display:inline-block}@media (max-width: 1024px){.desktop-add-btn[_ngcontent-%COMP%]{display:none}}.mobile-add-btn[_ngcontent-%COMP%]{display:none;margin-top:16px;background:#9bf526;color:#1a1a1a;border:none;border-radius:8px;padding:12px 20px;font-size:14px;font-weight:600;cursor:pointer;transition:all .2s ease;align-items:center;gap:8px}@media (max-width: 1024px){.mobile-add-btn[_ngcontent-%COMP%]{display:flex}}.mobile-add-btn[_ngcontent-%COMP%]:hover{background:#8ae01a;transform:translateY(-1px);box-shadow:0 4px 12px #9bf5264d}.mobile-add-btn[_ngcontent-%COMP%]:active{transform:translateY(0)}.mobile-add-btn.disabled[_ngcontent-%COMP%]{background:#4a4a4a;color:#8e8e93;cursor:not-allowed;opacity:.6}.mobile-add-btn.disabled[_ngcontent-%COMP%]:hover{background:#4a4a4a;transform:none;box-shadow:none}.mobile-add-btn[_ngcontent-%COMP%]   .icon-plus[_ngcontent-%COMP%]{font-size:16px;font-family:icomoon!important;display:inline-block}@media (max-width: 768px){.mobile-add-btn[_ngcontent-%COMP%]{display:flex}}']})};export{ye as TradingAccountsComponent};

import './polyfills.server.mjs';
import{a as S,b as l,c as i,e as g,g as E,i as f,j as d,k as I,l as P,m as b,n as R,q,s as o,u as v}from"./chunk-YWJXSM6M.mjs";import{W as h}from"./chunk-YCCZPWYV.mjs";import{a as c,b as y,k as n}from"./chunk-H4UZCO6D.mjs";q();v();var A=class u{constructor(){}getAllSubscriptionsByUserId(t){return n(this,null,function*(){try{let r=l(o,"users",t,"subscription"),e=g(r,E("created_at","desc")),a=yield d(e);return a.empty?(console.log("\u26A0\uFE0F No se encontraron pagos para el usuario:",t),[]):a.docs.map(s=>{let m=s.data();return c({id:s.id},m)})}catch(r){throw console.error("\u274C Error al obtener pagos:",r),console.error("Error details:",r),r}})}getSubscriptionById(t,r){return n(this,null,function*(){try{let e=i(o,"users",t,"subscriptions",r),a=yield f(e);return a.exists()?c({id:a.id},a.data()):null}catch(e){throw console.error("Error al obtener pago:",e),e}})}createSubscription(t,r){return n(this,null,function*(){try{let e=l(o,"users",t,"subscription"),a=S.now(),p=y(c({},r),{created_at:a,updated_at:a});return(yield R(e,p)).id}catch(e){throw console.error("Error al crear pago:",e),e}})}updateSubscription(t,r,e){return n(this,null,function*(){try{let a=i(o,"users",t,"subscription",r),p=y(c({},e),{updated_at:S.now()});yield P(a,p)}catch(a){throw console.error("Error al actualizar pago:",a),a}})}deleteSubscription(t,r){return n(this,null,function*(){try{let e=i(o,"users",t,"subscription",r);yield b(e)}catch(e){throw console.error("Error al eliminar pago:",e),e}})}getSubscriptionsByStatus(t,r){return n(this,null,function*(){try{let e=l(o,"users",t,"subscription"),a=g(e,E("created_at","desc"));return(yield d(a)).docs.map(s=>c({id:s.id},s.data())).filter(s=>s.status===r)}catch(e){throw console.error("Error al obtener pagos por estado:",e),e}})}getTotalSubscriptionsCount(t){return n(this,null,function*(){try{let r=l(o,"users",t,"subscription");return(yield d(r)).size}catch(r){throw console.error("Error al obtener conteo de pagos:",r),r}})}static \u0275fac=function(r){return new(r||u)};static \u0275prov=h({token:u,factory:u.\u0275fac,providedIn:"root"})};q();v();var x=class u{createPlan(t){return n(this,null,function*(){try{let r=y(c({},t),{createdAt:new Date,updatedAt:new Date});return yield I(i(o,"plan",r.id),r),r.id}catch(r){throw console.error("\u274C Error al crear plan:",r),r}})}getAllPlans(){return n(this,null,function*(){try{let t=l(o,"plan"),r=yield d(t);return r.empty?(console.log('\u26A0\uFE0F No se encontraron planes en la colecci\xF3n "plan"'),[]):r.docs.map(a=>{let p=a.data();return c({id:a.id},p)})}catch(t){return console.error("\u274C Error al obtener planes:",t),[]}})}getPlanById(t){return n(this,null,function*(){return f(i(o,"plan",t)).then(r=>c({id:r.id},r.data())).catch(r=>{console.error("\u274C Error al obtener el plan por ID:",r)})})}updatePlan(t,r){return n(this,null,function*(){try{let e=y(c({},r),{updatedAt:new Date});yield P(i(o,"plan",t),e)}catch(e){throw console.error("\u274C Error al actualizar plan:",e),e}})}deletePlan(t){return n(this,null,function*(){try{yield b(i(o,"plan",t))}catch(r){throw console.error("\u274C Error al eliminar plan:",r),r}})}searchPlansByName(t){return n(this,null,function*(){try{let r=l(o,"plan"),e=yield d(r);return e.empty?(console.log('\u26A0\uFE0F La colecci\xF3n "plan" est\xE1 vac\xEDa'),[]):(e.docs.forEach((s,m)=>{let w=s.data()}),e.docs.filter(s=>{let w=s.data().name?.toLowerCase()||"",D=t.toLowerCase();return w.includes(D)||D.includes(w)}).map(s=>{let m=s.data();return console.log("\u2705 Plan encontrado:",{id:s.id,name:m.name}),c({id:s.id},m)}))}catch(r){return console.error("\u274C Error en searchPlansByName:",r),[]}})}planExists(t){return n(this,null,function*(){try{return(yield f(i(o,"plan",t))).exists()||!1}catch(r){return console.error("\u274C Error al verificar existencia del plan:",r),!1}})}getPlansCount(){return n(this,null,function*(){return d(g(l(o,"plan"))).then(t=>t.docs.length).catch(t=>0)})}static \u0275fac=function(r){return new(r||u)};static \u0275prov=h({token:u,factory:u.\u0275fac,providedIn:"root"})};export{A as a,x as b};

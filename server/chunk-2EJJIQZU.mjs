import './polyfills.server.mjs';
import"./chunk-V6MSNGWX.mjs";import"./chunk-DX5WEOAP.mjs";import{a as D}from"./chunk-GJGTUHGS.mjs";import{a as R}from"./chunk-OKDPP6VB.mjs";import{a as U}from"./chunk-5ISIK2WD.mjs";import{b as G,c as B,e as d,f as C,g as v,j as _,m as w,n as P,u as y,w as M}from"./chunk-ZUEZAN7G.mjs";import{q as V,r as A}from"./chunk-5EV7JWWV.mjs";import{a as b}from"./chunk-SS4N7RKX.mjs";import{v as z}from"./chunk-YWJXSM6M.mjs";import{Ab as L,Cb as c,Eb as m,Ka as s,Pa as l,Rb as r,Sb as k,Va as h,ab as I,ea as S,fa as F,gd as N,lb as u,mb as f,qb as g,rb as o,sb as n,tb as x,zd as T}from"./chunk-YCCZPWYV.mjs";import"./chunk-RF6MMMYN.mjs";import{k as j}from"./chunk-H4UZCO6D.mjs";function H(a,t){a&1&&(o(0,"div",7),r(1,"Please enter a valid email address"),n())}function J(a,t){if(a&1&&(o(0,"div",11),r(1),n()),a&2){let e=m(2);s(),k(e.successMessage)}}function K(a,t){if(a&1&&(o(0,"div",7),r(1),n()),a&2){let e=m(2);s(),k(e.errorMessage)}}function Q(a,t){if(a&1){let e=L();o(0,"div",0)(1,"div",1)(2,"h2",2),r(3,"Forgot your password?"),n(),o(4,"p",3),r(5," Enter the email linked to your account and we'll send you instructions to reset your password. "),n(),o(6,"form",4),c("ngSubmit",function(){S(e);let p=m();return F(p.onSubmit())}),o(7,"label",5),r(8,"Email adress"),n(),x(9,"input",6),u(10,H,2,0,"div",7),o(11,"div",8)(12,"button",9),c("click",function(){S(e);let p=m();return F(p.onBack())}),r(13,"Back to login"),n(),o(14,"button",10),r(15,"Send reset link"),n()(),u(16,J,2,1,"div",11),u(17,K,2,1,"div",7),n()()()}if(a&2){let e=m();s(6),g("formGroup",e.form),s(4),f(e.submitted&&e.form.controls.email.invalid?10:-1),s(4),g("disabled",e.loading),s(2),f(e.successMessage?16:-1),s(),f(e.errorMessage?17:-1)}}var O=class a{constructor(t,e){this.fb=t;this.authService=e;this.form=this.fb.group({email:["",[d.required,d.email]]})}visible=!1;close=new I;form;submitted=!1;loading=!1;successMessage="";errorMessage="";onBack(){this.resetFeedback(),this.close.emit()}onSubmit(){return j(this,null,function*(){if(this.submitted=!0,this.successMessage="",this.errorMessage="",this.form.invalid||this.loading)return;this.loading=!0;let t=this.form.value.email;try{yield this.authService.sendPasswordReset(t),this.successMessage="We have sent you an email with instructions."}catch(e){e?.code==="auth/user-not-found"?this.errorMessage="No account found with this email.":e?.code==="auth/invalid-email"?this.errorMessage="Invalid email format.":this.errorMessage="Failed to send reset email. Please try again later."}finally{this.loading=!1}})}resetFeedback(){this.submitted=!1,this.successMessage="",this.errorMessage="",this.loading=!1}static \u0275fac=function(e){return new(e||a)(l(y),l(b))};static \u0275cmp=h({type:a,selectors:[["app-forgot-password-popup"]],inputs:{visible:"visible"},outputs:{close:"close"},decls:1,vars:1,consts:[[1,"popup-overlay","d-flex","items-center","justify-center"],[1,"popup-content","p-24","regularText","bg-bg-black","forgot-modal"],[1,"logoTitle","mb-16"],[1,"mb-16","color-secondary-200"],[1,"forgot-form",3,"ngSubmit","formGroup"],[1,"mb-8","color-secondary-200"],["type","email","placeholder","Enter your email","formControlName","email",1,"forgot-input"],[1,"error-text"],[1,"button-row","mt-16"],["type","button",1,"btn-secondary",3,"click"],["type","submit",1,"btn-primary",3,"disabled"],[1,"success-text"]],template:function(e,i){e&1&&u(0,Q,18,5,"div",0),e&2&&f(i.visible?0:-1)},dependencies:[N,M,_,B,C,v,w,P],styles:[".popup-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#00000080;z-index:1000}.popup-content[_ngcontent-%COMP%]{background:#23252b;border-radius:14px;width:460px;color:#fff;box-shadow:0 8px 40px #000000b3;text-align:left}.forgot-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.forgot-input[_ngcontent-%COMP%]{width:100%;padding:10px 12px;border-radius:8px;border:1px solid rgba(255,255,255,.2);background:transparent;color:#eaf2f8}.button-row[_ngcontent-%COMP%]{display:flex;gap:12px;justify-content:space-between}.btn-primary[_ngcontent-%COMP%]{flex:1;display:flex;align-items:center;justify-content:center;padding:10px;border-radius:6px;background:var(--Primary-400, #9bf526);color:var(--Black, #222325);cursor:pointer;transition:all .2s ease;border:none}.btn-primary[_ngcontent-%COMP%]:hover{background:var(--Primary-700, #468506)}.btn-secondary[_ngcontent-%COMP%]{flex:1;display:flex;align-items:center;justify-content:center;padding:10px;border-radius:6px;background:#ffffff1a;color:#eaf2f8;cursor:pointer;transition:all .2s ease;border:1px solid rgba(255,255,255,.2)}.error-text[_ngcontent-%COMP%]{color:#ff8a8a;font-size:12px}.success-text[_ngcontent-%COMP%]{color:#9bf526;font-size:12px}"]})};var q=class a{constructor(t,e,i,p,E){this.fb=t;this.authService=e;this.store=i;this.router=p;this.appContext=E;this.loginForm=this.fb.group({loginEmail:["",[d.required,d.email,this.emailValidator]],password:["",[d.required]],rememberMe:[!1]})}loginForm;showPassword=!1;forgotVisible=!1;onSubmit(){if(this.validateLoginFields(),this.loginForm.valid){let t=this.createUserCredentialsObject();this.appContext.setLoading("user",!0),this.appContext.setError("user",null),this.authService.login(t).then(e=>{this.authService.getUserData(e.user.uid).then(i=>{this.appContext.setCurrentUser(i),this.store.dispatch(D({user:i})),this.appContext.setLoading("user",!1),i.isAdmin?this.router.navigate(["/overview"]):this.router.navigate(["/strategy"])}).catch(i=>{this.appContext.setLoading("user",!1),this.appContext.setError("user","Error al obtener datos del usuario"),this.handleLoginError(i)})}).catch(e=>{this.appContext.setLoading("user",!1),this.appContext.setError("user","Error de autenticaci\xF3n"),this.handleLoginError(e)})}}openForgot(){this.forgotVisible=!0}closeForgot(){this.forgotVisible=!1}createUserCredentialsObject(){return{email:this.loginForm.value.loginEmail,password:this.loginForm.value.password}}togglePasswordVisibility(){this.showPassword=!this.showPassword}signInWithGoogle(){console.log("Google sign-in")}signInWithApple(){console.log("Apple sign-in")}emailValidator(t){return t.value?/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(t.value)?null:{invalidEmailFormat:!0}:null}validateLoginFields(){let t=[],e=this.loginForm.get("loginEmail"),i=this.loginForm.get("password");e?.errors?.required?t.push("Email is required"):e?.errors?.email?t.push("Invalid email format"):e?.errors?.invalidEmailFormat&&t.push("Invalid email format. Must contain @ and a valid domain"),i?.errors?.required&&t.push("Password is required"),t.length>0&&alert(`Validation errors:

`+t.join(`
`))}handleLoginError(t){console.error("Login error:",t);let e="Login failed. ";t.code==="auth/user-not-found"?e+="No account found with this email.":t.code==="auth/wrong-password"?e+="Incorrect password.":t.code==="auth/invalid-email"?e+="Invalid email format.":t.code==="auth/user-disabled"?e+="This account has been disabled.":t.code==="auth/too-many-requests"?e+="Too many failed attempts. Please try again later.":e+="Email or password is incorrect. Please check your credentials and try again.",alert(e)}static \u0275fac=function(e){return new(e||a)(l(y),l(b),l(T),l(V),l(z))};static \u0275cmp=h({type:a,selectors:[["app-login"]],decls:24,vars:2,consts:[[1,"login-container"],[1,"login-wrapper"],[1,"login-title"],[1,"login-subtitle"],[1,"login-form",3,"ngSubmit","formGroup"],["name","email","label","Email","placeholder","Your email here","formControlName","loginEmail","type","email",1,"form-input"],["label","Password","placeholder","Your password here","formControlName","password",1,"form-input"],[1,"login-options"],[1,"remember-me"],["type","checkbox","formControlName","rememberMe",1,"remember-me-checkbox"],["href","#",1,"forgot-password",3,"click"],["type","submit",1,"login-button"],[1,"signup-link"],["routerLink","/signup"],[3,"close","visible"]],template:function(e,i){e&1&&(o(0,"div",0)(1,"div",1)(2,"h1",2),r(3,"Welcome back"),n(),o(4,"p",3),r(5,"Log in to your account"),n(),o(6,"form",4),c("ngSubmit",function(){return i.onSubmit()}),x(7,"app-text-input",5)(8,"app-password-input",6),o(9,"div",7)(10,"label",8),x(11,"input",9),o(12,"div"),r(13,"Remember me"),n()(),o(14,"a",10),c("click",function(E){return E.preventDefault(),i.openForgot()}),r(15,"Forgot Your Password?"),n()(),o(16,"button",11),r(17," Log In "),n(),o(18,"div",12)(19,"div"),r(20,"Don\u2019t have an account?"),n(),o(21,"a",13),r(22,"Sign Up"),n()()()()(),o(23,"app-forgot-password-popup",14),c("close",function(){return i.closeForgot()}),n()),e&2&&(s(6),g("formGroup",i.loginForm),s(17),g("visible",i.forgotVisible))},dependencies:[M,_,G,C,v,w,P,U,R,A,O],styles:[".login-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:100%;height:100%}.login-wrapper[_ngcontent-%COMP%]{display:flex;width:500px;height:min-content;flex-direction:column;align-items:center;justify-content:center;color:#eaf2f8;font-family:SF Pro Display;gap:20px}.login-wrapper[_ngcontent-%COMP%]   .login-form[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column;gap:20px}.login-wrapper[_ngcontent-%COMP%]   .login-options[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:row;justify-content:space-between;margin:auto;color:#eaf2f8}@media (max-width: 348px){.login-wrapper[_ngcontent-%COMP%]   .login-options[_ngcontent-%COMP%]{flex-direction:column;align-items:start;gap:8px}}.login-wrapper[_ngcontent-%COMP%]   .signup-link[_ngcontent-%COMP%]{display:flex;flex-direction:row;width:100%;font-size:14px;gap:0px;justify-content:space-around;align-items:start}.login-wrapper[_ngcontent-%COMP%]   .signup-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#9bf526;text-decoration:none}.login-wrapper[_ngcontent-%COMP%]   .signup-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:underline}.login-wrapper[_ngcontent-%COMP%]   .remember-me[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;gap:8px;width:30%;font-size:14px;color:#eaf2f8}.login-wrapper[_ngcontent-%COMP%]   .remember-me-checkbox[_ngcontent-%COMP%]{margin-right:0;background-color:transparent;color:transparent}.login-wrapper[_ngcontent-%COMP%]   .login-title[_ngcontent-%COMP%]{align-self:stretch;color:var(--White, #eaf2f8);text-align:center;font-size:36px;font-style:normal;font-weight:700;line-height:22.264px;letter-spacing:-.435px;margin-bottom:0}.login-wrapper[_ngcontent-%COMP%]   .social-icon[_ngcontent-%COMP%]{width:16px;height:16px;margin-right:8px;margin-left:0}.login-wrapper[_ngcontent-%COMP%]   .social-button[_ngcontent-%COMP%]{flex:1;flex-direction:row;display:flex;align-items:center;justify-content:space-around;background:transparent;border:2px solid rgba(255,255,255,.3);border-radius:8px;padding:12px 16px;color:#fff;font-family:SF Pro Display;font-size:16px;text-align:left;font-style:normal;font-weight:10;line-height:14px;cursor:pointer;transition:all .2s ease}.login-wrapper[_ngcontent-%COMP%]   .social-button[_ngcontent-%COMP%]:hover{background:#ffffff1a}.login-wrapper[_ngcontent-%COMP%]   .login-methods-separator[_ngcontent-%COMP%]{display:flex;align-items:center;flex-direction:row;justify-content:space-between;font-family:SF Pro Display;gap:4px;color:#eaf2f8;font-size:16px}.login-wrapper[_ngcontent-%COMP%]   .separator-line[_ngcontent-%COMP%]{flex:1;height:1px;background:#8e8e93}.login-wrapper[_ngcontent-%COMP%]   .social-buttons-container[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:row;gap:16px}.login-wrapper[_ngcontent-%COMP%]   .forgot-password[_ngcontent-%COMP%]{color:#eaf2f8;text-decoration:none;font-size:14px}.login-wrapper[_ngcontent-%COMP%]   .forgot-password[_ngcontent-%COMP%]:hover{text-decoration:underline}.login-wrapper[_ngcontent-%COMP%]   .login-button[_ngcontent-%COMP%]{display:flex;padding:10px;justify-content:center;align-items:center;gap:10px;align-self:stretch;color:var(--Black, #222325);font-family:SF Pro Display;transition:all .2s ease;border-radius:6px;background:var(--Primary-400, #9bf526)}.login-wrapper[_ngcontent-%COMP%]   .login-button[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed;transform:none}.login-wrapper[_ngcontent-%COMP%]   .login-button[_ngcontent-%COMP%]:hover{background:var(--Primary-700, #468506);transform:translateY(-1px)}.login-wrapper[_ngcontent-%COMP%]   .forgot-modal[_ngcontent-%COMP%]{width:460px;border-radius:14px}.login-wrapper[_ngcontent-%COMP%]   .forgot-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.login-wrapper[_ngcontent-%COMP%]   .forgot-input[_ngcontent-%COMP%]{width:100%;padding:10px 12px;border-radius:8px;border:1px solid rgba(255,255,255,.2);background:transparent;color:#eaf2f8}.login-wrapper[_ngcontent-%COMP%]   .button-row[_ngcontent-%COMP%]{display:flex;gap:12px;justify-content:space-between}.login-wrapper[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]{flex:1;display:flex;align-items:center;justify-content:center;padding:10px;border-radius:6px;background:var(--Primary-400, #9bf526);color:var(--Black, #222325);cursor:pointer;transition:all .2s ease;border:none}.login-wrapper[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]:hover{background:var(--Primary-700, #468506)}.login-wrapper[_ngcontent-%COMP%]   .btn-secondary[_ngcontent-%COMP%]{flex:1;display:flex;align-items:center;justify-content:center;padding:10px;border-radius:6px;background:#ffffff1a;color:#eaf2f8;cursor:pointer;transition:all .2s ease;border:1px solid rgba(255,255,255,.2)}.login-wrapper[_ngcontent-%COMP%]   .error-text[_ngcontent-%COMP%]{color:#ff8a8a;font-size:12px}.login-wrapper[_ngcontent-%COMP%]   .success-text[_ngcontent-%COMP%]{color:#9bf526;font-size:12px}"]})};export{q as Login};
